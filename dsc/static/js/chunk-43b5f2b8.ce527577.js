(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43b5f2b8"],{1886:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("div",{staticClass:"contentBox"},[a("header",[a("div",{staticClass:"headLeft"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.createFolder}},[a("i",{staticClass:"iconfont icon-xinjianwenjian"}),t._v(" 新建文件夹 ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.uploadFile}},[a("i",{staticClass:"iconfont icon-upload"}),t._v(" 上传文件 ")]),a("el-button",{staticStyle:{background:"#0eafc0"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.createApply(t.selectData)}}},[a("i",{staticClass:"iconfont icon-fileDownload"}),t._v(" 下载申请 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.selectData.length>0,expression:"selectData.length > 0"}],attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(e){return t.delFile(t.selectData)}}},[a("i",{staticClass:"iconfont icon-delete"}),t._v(" 删除 ")])],1),a("div",{staticClass:"headRight"},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入文件名","suffix-icon":"el-icon-search",size:"small"},model:{value:t.filterName,callback:function(e){t.filterName=e},expression:"filterName"}}),t.isTable?a("i",{staticClass:"iconfont icon-caidan",attrs:{title:"按图标排列"},on:{click:function(e){t.isTable=!1}}}):a("i",{staticClass:"iconfont icon-liebiao",attrs:{title:"按表格排列"},on:{click:function(e){t.isTable=!0}}})],1)]),a("div",{staticClass:"breadCrumbBox"},[a("bread-crumb",{on:{startGetData:t.startGetData},model:{value:t.nowPath,callback:function(e){t.nowPath=e},expression:"nowPath"}})],1),t.isTable?a("div",{staticClass:"tableWrap"},[a("table-temp",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{config:t.tableConfig},on:{"selection-change":t.handleSelectionChange,cellMouseEnter:t.cellMouseEnter,cellMouseLeave:t.cellMouseLeave},scopedSlots:t._u([{key:"file",fn:function(e){return[a("div",{staticClass:"fileWrap"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.dir,expression:"scope.row.dir"}],staticClass:"fileIcon",style:{background:"url("+t.iconPath.folder+")",backgroundSize:"100% 100%"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.row.dir,expression:"!scope.row.dir"}],staticClass:"fileIcon",style:{background:"url("+t.iconPath.file+")",backgroundSize:"100% 100%"}}),a("div",{staticClass:"fileName"},[e.row.isEdit?a("el-input",{ref:"editInput",attrs:{placeholder:"请输入文件名",size:"mini"},model:{value:e.row.tempName,callback:function(a){t.$set(e.row,"tempName",a)},expression:"scope.row.tempName"}},[a("el-button",{attrs:{slot:"append"},on:{click:function(a){return t.editFileName(e.row)}},slot:"append"},[a("i",{staticClass:"el-icon-check"})])],1):a("span",{class:{clickable:e.row.dir},attrs:{title:e.row.name},on:{click:function(a){e.row.dir&&t.getData(e.row.path)}}},[t._v(" "+t._s(e.row.name)+" ")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row.showOperate,expression:"scope.row.showOperate"}],staticClass:"operate"},[a("i",{directives:[{name:"show",rawName:"v-show",value:!e.row.isEdit,expression:"!scope.row.isEdit"}],staticClass:"iconfont icon-edit",attrs:{title:"编辑"},on:{click:function(a){return a.stopPropagation(),t.showEditName(e.row)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:e.row.isEdit,expression:"scope.row.isEdit"}],staticClass:"iconfont icon-quxiao",attrs:{title:"取消编辑"},on:{click:function(a){return t.cancelEdit(e.row)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.row.dir,expression:"!scope.row.dir"}],staticClass:"iconfont icon-xiazai",attrs:{title:"下载"},on:{click:function(a){return a.stopPropagation(),t.createApply([e.row])}}}),a("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"#fa5252",title:"删除后不可恢复，确定删除吗？"},on:{confirm:function(a){return t.confirmDel(e.row)},cancel:function(a){return t.cancelDel(e.row)}}},[a("i",{staticClass:"iconfont icon-trash",style:{color:t.tempDelId==e.row.id?"#fa5252":"#339af0"},attrs:{slot:"reference",title:"删除"},on:{click:function(a){a.stopPropagation(),t.tempDelId=e.row.id}},slot:"reference"})])],1)])]}}],null,!1,3100956857)})],1):a("div",{staticClass:"isIconWrap"},[a("el-divider"),t.tableConfig.tableData.length>0?a("div",{staticClass:"fileWrap"},[t._l(t.tableConfig.tableData,(function(e,i){return[a("el-tooltip",{key:i,attrs:{effect:"dark",placement:"top","open-delay":400}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[t._v("文件名称："+t._s(e.name))]),a("div",[t._v("文件大小："+t._s(e.size))]),a("div",[t._v("修改日期："+t._s(e.lastModified))])]),a("div",{staticClass:"fileBox",class:{checked:e.checked},on:{click:function(a){e.dir?t.getData(e.path):t.selectedFile(e)}}},[e.checked?a("i",{staticClass:"el-icon-success"}):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dir,expression:"item.dir"}],staticClass:"fileIcon",style:{background:"url("+t.iconPath.folder+")",backgroundSize:"100% 100%"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.dir,expression:"!item.dir"}],staticClass:"fileIcon",style:{background:"url("+t.iconPath.file+")",backgroundSize:"100% 100%"}}),a("div",{staticClass:"fileName"},[t._v(t._s(e.name))])])])]}))],2):a("el-empty",{attrs:{description:"暂无数据"}})],1)]),a("el-dialog",{attrs:{visible:t.addFolderDialog,width:"500px"},on:{"update:visible":function(e){t.addFolderDialog=e}}},[a("template",{slot:"title"},[a("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 新建文件夹 ")])]),a("div",{staticStyle:{"margin-bottom":"5px","font-size":"13px"}},[t._v("请选择路径")]),a("div",{staticClass:"fileTreeWrap"},[a("el-tree",{ref:"tree",staticStyle:{width:"300px"},attrs:{props:t.props,load:t.loadNode,"node-key":"label",lazy:"","empty-text":"暂无数据"},on:{"node-click":t.nodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;return a("span",{staticClass:"nodeItem"},[a("span",{staticStyle:{"font-size":"13px"},attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"iconfont icon-filePool",staticStyle:{"margin-right":"2px"}}),t._v(" "+t._s(i.label)+" ")])])}}])})],1),a("div",{staticClass:"pathBox"},[t._v("目标路径："+t._s(t.targetPath))]),a("el-input",{staticStyle:{"margin-top":"5px"},attrs:{size:"small",placeholder:"请输入文件夹名称"},model:{value:t.folderName,callback:function(e){t.folderName=e},expression:"folderName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.addFolderDialog=!1}}},[t._v(" 取 消 ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.createDirectory}},[t._v(" 确 定 ")])],1)],2),t.uploadDialog?a("upload-dialog",{on:{goGetData:t.goGetData},model:{value:t.uploadDialog,callback:function(e){t.uploadDialog=e},expression:"uploadDialog"}}):t._e()],1)},s=[],o=(a("4de4"),a("d3b7"),a("b0c0"),a("d81d"),a("8efb")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:t.tempVal,width:"550px",top:"4%"},on:{"update:visible":function(e){t.tempVal=e},close:t.dialogClose}},[a("template",{slot:"title"},[a("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 文件上传 ")])]),a("div",{staticStyle:{"margin-bottom":"5px","font-size":"13px"}},[t._v(" 请选择路径（再次点击选中路径取消选中） ")]),a("div",{staticClass:"fileTreeWrap"},[a("el-tree",{ref:"tree",staticStyle:{width:"300px"},attrs:{props:t.props,load:t.loadNode,"node-key":"label",lazy:"","empty-text":"暂无数据"},on:{"node-click":t.nodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;return a("span",{staticClass:"nodeItem"},[a("span",{staticStyle:{"font-size":"13px"},attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"iconfont icon-filePool",staticStyle:{"margin-right":"2px"}}),t._v(" "+t._s(i.label)+" ")])])}}])})],1),a("div",{staticClass:"pathBox"},[t._v("目标路径："+t._s(t.targetPath))]),a("el-divider"),a("div",{staticClass:"uploadWrap"},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-remove":t.handleRemove,"show-file-list":!1,"auto-upload":!1,"on-change":t.onUploadChange,"http-request":t.uploadFile,"file-list":t.fileList,multiple:""}},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[t._v(" 选取文件 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"success",disabled:t.fileList.length<=0},on:{click:t.submitUpload}},[t._v(" 上传到服务器 ")])],1),a("div",{staticClass:"fileList"},t._l(t.fileList,(function(e,i){return a("div",{key:e.uid,staticClass:"fileItem"},[a("div",{staticClass:"fileName"},[t._v(t._s(e.name))]),a("div",{staticClass:"fileSize"},[t._v(t._s(e.size))]),e.loading?a("div",{staticClass:"loading"},[t._v("上传中...")]):a("div",{staticClass:"fileState"},["ready"==e.status?a("i",{staticClass:"el-icon-close",on:{click:function(a){return t.delUploadFile(e,i)}}}):t._e(),"error"==e.status?a("i",{staticClass:"el-icon-warning"}):t._e(),"success"==e.status?a("i",{staticClass:"el-icon-success"}):t._e()])])})),0)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("关 闭")])],1)],2)],1)},n=[],c=(a("a434"),a("bc3a")),r=a.n(c),d=a("b8f0"),p={name:"uploadDialog",props:{value:Boolean},data:function(){return{tempVal:!1,uploadUrl:"",targetPath:"",props:{label:"name",isLeaf:"leaf"},fileList:[],rootPath:"",baseUrl:""}},created:function(){this.baseUrl=this.$store.getters.symSetting.uploadUrl,this.fileList=[]},watch:{value:{handler:function(t){this.tempVal=t},immediate:!0}},methods:{loadNode:function(t,e){var a=0==t.level?"":t.data.path;this.$http("getFileList",{path:a}).then((function(t){var a=[];t.data.map((function(t){t.dir&&a.push({name:t.name,path:t.path,leaf:!t.dir})})),e(a)}))},nodeClick:function(t){this.targetPath!=t.path?this.targetPath=t.path:this.targetPath="/"},uploadFile:function(t){var e=this,a=t.file,i=0,s=new FormData;s.append("file",a,a.name),this.fileList.map((function(t,s){t.uid==a.uid&&(e.$set(t,"loading",!0),i=s)})),this.$http("createToken",{path:this.targetPath,fileName:a.name,type:1}).then((function(t){r.a.post(e.baseUrl+"upload?token="+t.data,s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){0==t.data.errCode?(e.$set(e.fileList[i],"status","success"),e.$set(e.fileList[i],"loading",!1),e.$message.success(a.name+"上传到"+e.targetPath+"路径成功")):(e.$set(e.fileList[i],"status","error"),e.$set(e.fileList[i],"loading",!1),e.$message.warning(a.name+"："+t.data.errMsg))}))}))},onUploadChange:function(t){var e=!1;t.size=Object(d["d"])(t.size),this.fileList.map((function(a){a.uid==t.uid&&(a=t,e=!0)})),e||this.fileList.push(t)},delUploadFile:function(t,e){console.log(t,e),this.fileList.splice(e,1)},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){console.log(t,e)},handleNodeClick:function(t){this.targetPath=t.label,console.log(t)},cancel:function(){this.$emit("input",!1),this.$emit("goGetData",!0),this.targetPath="/",this.fileList=[]},dialogClose:function(){this.$emit("input",!1),this.$emit("goGetData",!0),this.targetPath="/",this.fileList=[]}}},f=p,h=(a("ff28"),a("2877")),u=Object(h["a"])(f,l,n,!1,null,"19f21712",null),m=u.exports,g=a("2c4e"),v={name:"soFile",components:{tableTemp:o["a"],uploadDialog:m,breadCrumb:g["a"]},data:function(){return{iconPath:{file:a("f3d3"),folder:a("589a")},filterName:"",fullData:[],tempDelId:"",folderName:"",selectedList:[],props:{label:"name",isLeaf:"leaf"},isIndeterminate:!0,uploadDialog:!1,addFolderDialog:!1,nowPath:"",checkAll:!1,isTable:!0,tableLoading:!1,tableConfig:{tableData:[],maxHeight:"10000px",selection:!0,stripe:!1,border:!1,headerCellStyle:{background:"#f7f9fd",height:"35px",lineHeight:"35px",fontSize:"15px"},tableSetting:[{prop:"name",label:"文件名",align:"left",slot:"file",minWidth:"400px"},{prop:"size",label:"大小"},{prop:"lastModified",label:"修改日期"}]},selectData:[],targetPath:"/",node:"",resolve:""}},created:function(){},mounted:function(){this.tableConfig.maxHeight=document.body.clientHeight-220+"px",this.getData(this.nowPath)},watch:{filterName:function(t){this.$set(this.tableConfig,"tableData",this.fullData.filter((function(e){if(-1!=e.name.indexOf(t))return e})))}},methods:{nodeClick:function(t){this.targetPath!=t.path?this.targetPath=t.path:this.targetPath="/"},loadNode:function(t,e){var a=this,i=0==t.level?"":t.data.path;this.$http("getFileList",{path:i}).then((function(i){var s=[];i.data.map((function(t){t.dir&&s.push({name:t.name,path:t.path,leaf:!t.dir})})),e(s),a.node=t,a.resolve=e}))},createFolder:function(){this.folderName="",this.node&&this.resolve&&this.loadNode(this.node,this.resolve),this.addFolderDialog=!0},createApply:function(t){var e=t.map((function(t){return{fileSize:t.size,filePath:t.path,fileName:t.name,size:Object(d["d"])(t.size)}})),a={applyUser:localStorage.getItem("username")||"",applyEmail:"",applyTheme:"",describe:"",applyType:1,downloadDay:1,downloadCount:1,fileList:e,approvalUserList:[]};this.$store.commit("SET_DOWNLOADFORM",a),this.$router.push({name:"newOrEditApply",params:{type:0,data:a}})},createDirectory:function(){var t=this;this.folderName?this.$http("createDirectory",{fileName:this.folderName,path:this.targetPath}).then((function(e){t.$message.success(e.errMsg)})).finally((function(){t.addFolderDialog=!1,t.getData(t.nowPath)})):this.$message.warning("文件夹名称不能为空")},startGetData:function(t){t&&this.getData(this.nowPath)},getData:function(t){var e,a=this;this.tableLoading=!0,e=t?"/"==t[t.length-1]?t:t+"/":"/",this.$http("getFileList",{path:e}).then((function(t){t.data.map((function(t){t.size=Object(d["d"])(t.size)})),a.tableConfig.tableData=t.data,a.fullData=t.data,a.nowPath=e})).finally((function(){a.tableLoading=!1}))},confirmDel:function(t){this.delFile([t]),this.tempDelId="",this.$set(t,"showOperate",!1)},cancelDel:function(t){this.tempDelId="",this.$set(t,"showOperate",!1)},handleCheckAllChange:function(t){console.log(t)},selectedFile:function(t){t.checked?this.$set(t,"checked",!1):this.$set(t,"checked",!0)},clickDel:function(t){var e=this,a=t.map((function(t){return t.path}));this.$confirm("删除后不可恢复，是否删除所选文件？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){e.delFile(a)}))},delFile:function(t){var e=this;t.map((function(a,i){e.$http("delete",{path:e.nowPath,fileName:a.dir?a.name+"/":a.name}).then((function(a){i==t.length-1&&(e.getData(e.nowPath),e.$message.success(a.errMsg))}))}))},showEditName:function(t){this.$set(t,"tempName",t.name),this.$set(t,"isEdit",!0)},goGetData:function(t){t&&this.getData(this.nowPath)},editFileName:function(t){var e=this;""!=t.tempName?this.$http("rename",{newName:t.tempName,path:this.nowPath,fileName:t.name}).then((function(t){e.$message.success(t.errMsg),e.getData(e.nowPath)})).finally((function(){e.$set(t,"isEdit",!1)})):this.$message.warning("文件名不能为空")},cancelEdit:function(t){this.$set(t,"isEdit",!1)},uploadFile:function(){this.uploadDialog=!0},handleSelectionChange:function(t){this.selectData=t},cellMouseEnter:function(t){this.$set(t,"showOperate",!0)},cellMouseLeave:function(t){this.tempDelId!=t.id&&this.$set(t,"showOperate",!1)}}},b=v,w=(a("2ebc"),Object(h["a"])(b,i,s,!1,null,"211be7c0",null));e["default"]=w.exports},"2da4":function(t,e,a){},"2ebc":function(t,e,a){"use strict";a("2da4")},"4c91":function(t,e,a){},"589a":function(t,e,a){t.exports=a.p+"static/img/folder.83b61646.png"},f3d3:function(t,e,a){t.exports=a.p+"static/img/file.b6a1d726.png"},ff28:function(t,e,a){"use strict";a("4c91")}}]);