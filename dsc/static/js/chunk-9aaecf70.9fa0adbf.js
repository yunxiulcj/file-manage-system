(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9aaecf70"],{"0004":function(t,a,e){"use strict";e("e496")},"1d11":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"box"},[e("div",{staticClass:"tabBox"},[e("div",{staticClass:"filter"},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.activeName||2==t.activeName,expression:"activeName == 0 || activeName == 2"}],staticStyle:{"font-weight":"600","margin-right":"20px"},attrs:{type:"text"},on:{click:t.MarkRead}},[t._v(" 全部标记为已读 ")]),e("el-select",{attrs:{size:"mini"},model:{value:t.filterTime,callback:function(a){t.filterTime=a},expression:"filterTime"}},t._l(t.timeRange,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-tabs",{model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"全部消息",name:"2"}},[t.messageList.length>0?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"itemWrap"},[e("message-item",{attrs:{messageList:t.messageList}})],1):e("el-empty",{attrs:{description:"暂无数据"}})],1),e("el-tab-pane",{attrs:{name:"0"}},[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 未读消息 "),e("el-badge",{staticClass:"item",attrs:{value:t.unread,hidden:t.unread<=0,type:"primary"}})],1),t.messageList.length>0?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"itemWrap"},[e("message-item",{attrs:{messageList:t.messageList}})],1):e("el-empty",{attrs:{description:"暂无数据"}})],1),e("el-tab-pane",{attrs:{label:"已读消息",name:"1"}},[t.messageList.length>0?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"itemWrap"},[e("message-item",{attrs:{messageList:t.messageList}})],1):e("el-empty",{attrs:{description:"暂无数据"}})],1)],1)],1)])},i=[],l=(e("d81d"),e("d3b7"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"itemBox"},[t._l(t.messageList,(function(a){return e("div",{key:a.id,staticClass:"messageWrap"},[e("div",{staticClass:"messageBox"},[e("div",{staticClass:"topWrap"},[e("div",{class:{isRead:!a.read}}),e("div",{staticClass:"topPart"},[e("div",{staticClass:"messageTop"},[e("div",{staticClass:"title"},[t._v(t._s(a.title))]),e("el-tag",{staticClass:"state",attrs:{type:t.tagType[a.applyState],size:"small"}},[t._v(" "+t._s(t.stateType[a.applyState])+" ")]),e("div",{staticClass:"startTime"},[t._v(t._s(a.noticeTime))])],1),e("div",{staticClass:"messageContent"},[e("div",{staticClass:"infoTop"},[e("div",{staticClass:"applyUser infoItem"},[e("span",{staticClass:"label"},[t._v("申请人：")]),t._v(" "+t._s(a.applyUser)+" ")]),e("el-divider",{attrs:{direction:"vertical"}}),e("div",{staticClass:"periodValidity infoItem"},[e("span",{staticClass:"label"},[t._v("有效期：")]),a.dayUnlimited?e("span",[t._v("永久")]):e("span",[t._v(" "+t._s(a.expiredStartTime)+" 至 "+t._s(a.expiredEndTime)+" ")])]),e("el-divider",{attrs:{direction:"vertical"}}),e("div",{staticClass:"detail infoItem",on:{click:function(e){return t.showDetail(a)}}},[t._v(" 详情 ")])],1),e("div",{staticClass:"infoBottom"},[e("div",{staticClass:"noBtn",style:1!=a.state?{width:"100%"}:{width:"85%"}},[e("div",{staticClass:"describe infoItem"},[e("span",{staticClass:"label"},[t._v("申请描述：")]),t._v(" "+t._s(a.applyDesc)+" ")])]),a.canApproval?e("div",{staticClass:"btnBox"},[e("el-button",{attrs:{type:"success",size:"mini",plain:"",round:""},on:{click:function(e){return t.clickOnAgree(a)}}},[t._v(" 同意 ")]),e("el-button",{attrs:{type:"warning",size:"mini",plain:"",round:""},on:{click:function(e){return t.clickReject(a)}}},[t._v(" 拒绝 ")])],1):t._e()])])])]),e("el-divider"),a.attachmentList&&a.attachmentList.length>0?e("div",{staticClass:"messageBottom"},t._l(a.attachmentList,(function(a){return e("div",{key:a.fileName,staticClass:"fileWrap"},[e("div",{staticClass:"fileBox"},[e("div",{staticClass:"fileName"},[t._v(t._s(a.fileName))]),e("div",{staticClass:"fileInfo"},[e("div",{staticClass:"fileSize"},[t._v(" "+t._s(a.fileSize)+" ")]),a.canDownload?e("div",{staticClass:"download",on:{click:function(e){return t.downFile(a)}}},[t._v(" 下载 ")]):t._e()])])])})),0):t._e()],1)])})),e("el-dialog",{attrs:{visible:t.agreeOrRefuseDialog,width:"500px"},on:{"update:visible":function(a){t.agreeOrRefuseDialog=a}}},[e("template",{slot:"title"},[e("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 提示 ")])]),e("el-form",{attrs:{size:"small"}},[t.canEdit?e("el-form-item",{attrs:{label:"下载次数"}},[e("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:t.editForm.downloadCount,callback:function(a){t.$set(t.editForm,"downloadCount",a)},expression:"editForm.downloadCount"}}),e("span",{staticClass:"unit"},[t._v("单位：天")]),e("el-divider",{attrs:{direction:"vertical"}}),e("span",{staticClass:"tips"},[t._v("注：0表示长期有效")])],1):t._e(),t.canEdit?e("el-form-item",{attrs:{label:"申请有效期"}},[e("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:t.editForm.downloadExpiredDay,callback:function(a){t.$set(t.editForm,"downloadExpiredDay",a)},expression:"editForm.downloadExpiredDay"}}),e("span",{staticClass:"unit"},[t._v("单位：天")]),e("el-divider",{attrs:{direction:"vertical"}}),e("span",{staticClass:"tips"},[t._v("注：0表示长期有效")])],1):t._e(),e("el-form-item",{attrs:{label:"理由"}},[e("el-input",{model:{value:t.editForm.comment,callback:function(a){t.$set(t.editForm,"comment",a)},expression:"editForm.comment"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(a){t.agreeOrRefuseDialog=!1}}},[t._v(" 取 消 ")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.confirmEdit}},[t._v(" 确 定 ")])],1)],2),e("el-dialog",{attrs:{visible:t.detailDialog},on:{"update:visible":function(a){t.detailDialog=a}}},[e("template",{slot:"title"},[e("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 审批详情 ")])]),e("div",{staticClass:"contentBox"},[e("timeline",{attrs:{data:t.detailData,approvalState:t.approvalState}})],1)],2)],2)}),n=[],o=(e("3ca3"),e("ddb0"),e("2b3d"),e("9861"),e("d1c6")),d=e("b8f0"),c={name:"messageItem",props:{messageList:Array},components:{timeline:o["a"]},data:function(){return{canEdit:!1,agreeOrRefuseDialog:!1,editForm:{applyId:"",applyStatus:1,downloadCount:1,downloadExpiredDay:1,comment:""},detailDialog:!1,tagType:{1:"warning",2:"",3:"",4:"success",5:"danger",6:"danger"},applyType:{1:"公网上传申请",2:"外发申请",3:"文件下载申请",4:"文件上传",5:"删除",6:"邀请加入",7:"重命名",8:"移除",9:"创建"},stateType:{1:"已撤回",2:"待处理",3:"审批中",4:"审批通过",5:"审批拒绝",6:"传输异常"},detailData:{},approvalState:0}},computed:{},watch:{},created:function(){},methods:{confirmEdit:function(){var t=this,a=1==this.editForm.applyStatus?"agree":"refuse";this.$http(a,this.editForm).then((function(a){t.$message.success(a.errMsg)}))},showDetail:function(t){var a=this;this.$http("getApplyDetail",{applyId:t.applyId,type:t.applyDetailType}).then((function(t){t.data&&(t.data.fileList.map((function(t){t.fileSize=Object(d["d"])(t.fileSize)})),a.detailData=t.data)})),this.detailDialog=!0,console.log(t)},downFile:function(t){this.$http("download",{path:"/"+t.fileName,fileName:t.fileName,fileId:t.fileId}).then((function(a){var e=document.createElement("a"),s=new Blob(a);e.href=URL.createObjectURL(s),e.download=t.fileName,e.click()}))},clickOnAgree:function(t){var a=this;t.canEdit?(this.editForm.applyId=t.applyId,this.editForm.applyStatus=1,this.editForm.downloadCount=t.downloadCount,this.editForm.downloadExpiredDay=t.downloadDay,this.canEdit=t.canEdit,this.agreeOrRefuseDialog=!0):this.$confirm("是否同意当前申请？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"info",center:!0}).then((function(){a.$http("agree",{applyId:t.applyId,applyStatus:1,downloadCount:t.downloadCount,downloadExpiredDay:t.downloadDay,comment:""})}))},clickReject:function(t){this.editForm.applyId=t.applyId,this.editForm.approvalState=2,this.editForm.downloadCount=t.downloadCount,this.editForm.downloadExpiredDay=t.downloadDay,this.canEdit=!1,this.agreeOrRefuseDialog=!0}}},r=c,p=(e("0004"),e("2877")),m=Object(p["a"])(r,l,n,!1,null,"3077e448",null),u=m.exports,v=e("c1df"),f=e.n(v),g={name:"message",components:{messageItem:u},data:function(){return{unread:0,activeName:"2",loading:!1,filterTime:1,timeRange:[{label:"最近七天",value:1},{label:"最近十五天",value:2},{label:"最近一个月",value:3},{label:"最近三个月",value:4}],messageList:[]}},watch:{activeName:{handler:function(t){this.messageList=[],this.getNoticeList(t)},immediate:!0}},created:function(){},mounted:function(){this.getUserUnreadNoticeNum()},methods:{MarkRead:function(){var t=this,a=this.messageList.map((function(t){return t.id}));this.$http("setNoticeRead",{noticeIdList:a}).then((function(a){t.$message.success(a.errMsg)})).finally((function(){t.getNoticeList(t.activeName),t.getUserUnreadNoticeNum()}))},getUserUnreadNoticeNum:function(){var t=this;this.$http("getUserUnreadNoticeNum").then((function(a){t.unread=a.data}))},getNoticeList:function(t){var a=this;this.loading=!0;var e="",s="";switch(this.filterTime){case 1:e=f()().subtract(7,"days").format("YYYY-MM-DD HH:mm:ss"),s=f()().format("YYYY-MM-DD HH:mm:ss");break;case 2:e=f()().subtract(15,"days").format("YYYY-MM-DD HH:mm:ss"),s=f()().format("YYYY-MM-DD HH:mm:ss");break;case 3:e=f()().subtract(30,"days").format("YYYY-MM-DD HH:mm:ss"),s=f()().format("YYYY-MM-DD HH:mm:ss");break;case 4:e=f()().subtract(90,"days").format("YYYY-MM-DD HH:mm:ss"),s=f()().format("YYYY-MM-DD HH:mm:ss");break;default:break}this.$http("getNoticeList",{noticeType:t,startTime:e,endTime:s}).then((function(t){t.data&&(t.data.map((function(t){t.attachmentList.map((function(t){t["fileSize"]=Object(d["d"])(t.fileSize)}))})),a.messageList=t.data,console.log(a.messageList))})).finally((function(){a.loading=!1}))}}},h=g,y=(e("4c9d"),Object(p["a"])(h,s,i,!1,null,"89660ebe",null));a["default"]=y.exports},"1d2e":function(t,a,e){},"4c9d":function(t,a,e){"use strict";e("fa45")},d1c6:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-timeline",[e("el-timeline-item",{attrs:{type:"success"}},[e("span",{staticClass:"labelBox"},[t._v("申请成功")]),e("div",{staticClass:"infoWrap"},[e("div",{staticClass:"timeBox"},[t._v(t._s(t.data.applyTime))]),e("div",{staticClass:"infoBox"},[e("div",{staticClass:"applyId apply"},[e("span",{staticClass:"label"},[t._v("工单号：")]),t._v(" "+t._s(t.data.applyId)+" ")]),e("div",{staticClass:"applyUser apply"},[e("span",{staticClass:"label"},[t._v("申请人：")]),t._v(" "+t._s(t.data.applyUser)+" "),e("el-divider",{attrs:{direction:"vertical"}}),e("span",{staticStyle:{"font-weight":"bolder"}},[t._v(t._s(t.data.userDept))])],1),e("div",{staticClass:"applyDesc apply"},[e("span",{staticClass:"label"},[t._v("描述：")]),t._v(" "+t._s(t.data.applyDesc)+" ")]),e("div",{staticClass:"downloadCount apply"},[e("span",{staticClass:"label"},[t._v("下载次数：")]),t.data.canEdit?e("span",{staticClass:"canBeModifi"},[e("el-input-number",{staticStyle:{"margin-left":"12px"},attrs:{"controls-position":"right",size:"small",min:0},model:{value:t.data.downloadCount,callback:function(a){t.$set(t.data,"downloadCount",a)},expression:"data.downloadCount"}}),e("span",{staticClass:"unit"},[t._v("单位：次")]),e("el-divider",{attrs:{direction:"vertical"}}),e("span",{staticClass:"tips"},[t._v("注：0表示没有限制")])],1):e("span",{staticClass:"noModifi"},[t._v(t._s(t.data.downloadCount)+" 次")])]),e("div",{staticClass:"expiredDay apply"},[e("span",{staticClass:"label"},[t._v("申请有效期：")]),t.data.canEdit?e("span",{staticClass:"canBeModifi"},[e("el-input-number",{attrs:{"controls-position":"right",size:"small",min:0},model:{value:t.data.downloadDay,callback:function(a){t.$set(t.data,"downloadDay",a)},expression:"data.downloadDay"}}),e("span",{staticClass:"unit"},[t._v("单位：天")]),e("el-divider",{attrs:{direction:"vertical"}}),e("span",{staticClass:"tips"},[t._v("注：0表示长期有效")])],1):e("span",{staticClass:"noModifi"},[t._v(t._s(t.data.downloadDay)+" 天")])])])])]),t._l(t.data.processList,(function(a,s){return e("el-timeline-item",{key:s,attrs:{type:3==a.state||2==a.state?"primary":4==a.state?"success":"danger"}},[0==s?e("span",{staticClass:"labelBox"},[t._v("审批中")]):t._e(),e("span",{staticClass:"timeBox"},[t._v(t._s(a.approvalTime))]),e("span",{staticClass:"approvaler"},[e("span",{staticClass:"label"},[t._v("审批人：")]),t._v(" "+t._s(a.user)+" ")]),e("span",{staticClass:"state",style:{color:3==a.state||2==a.state?"#228be6":4==a.state?"#40c057":5==a.state||6==a.state?"#f03e3e":"#868e96"}},[t._v(" "+t._s(t.state[a.state])+" ")]),a.reason?e("span",{staticClass:"reason"},[e("span",{staticClass:"label"},[t._v("理由：")]),t._v(" "+t._s(a.reason)+" ")]):t._e()])})),4==t.approvalState||5==t.approvalState?e("el-timeline-item",{attrs:{type:4==t.approvalState?"success":"danger"}},[e("span",{staticClass:"labelBox"},[t._v(t._s(t.state[t.approvalState]))]),e("div",{staticClass:"timeBox"},[t._v(t._s(t.data.approvalTime))])]):t._e()],2)},i=[],l={name:"timeline",props:["data","approvalState"],data:function(){return{state:{1:"已撤回",2:"待处理",3:"审批中",4:"审批通过",5:"审批不通过"}}},created:function(){},methods:{}},n=l,o=(e("f59e"),e("2877")),d=Object(o["a"])(n,s,i,!1,null,"a425a556",null);a["a"]=d.exports},e496:function(t,a,e){},f59e:function(t,a,e){"use strict";e("1d2e")},fa45:function(t,a,e){}}]);