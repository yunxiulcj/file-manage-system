(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d55664a"],{"00fc":function(e,t,s){"use strict";s("81ce")},"0492":function(e,t,s){},1276:function(e,t,s){"use strict";var i=s("2ba4"),a=s("c65b"),n=s("e330"),o=s("d784"),l=s("44e7"),r=s("825a"),c=s("1d80"),p=s("4840"),d=s("8aa5"),u=s("50c4"),f=s("577e"),v=s("dc4a"),m=s("4dae"),h=s("14c3"),b=s("9263"),g=s("9f7f"),y=s("d039"),C=g.UNSUPPORTED_Y,w=4294967295,_=Math.min,x=[].push,O=n(/./.exec),j=n(x),N=n("".slice),L=!y((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var s="ab".split(e);return 2!==s.length||"a"!==s[0]||"b"!==s[1]}));o("split",(function(e,t,s){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,s){var n=f(c(this)),o=void 0===s?w:s>>>0;if(0===o)return[];if(void 0===e)return[n];if(!l(e))return a(t,n,e,o);var r,p,d,u=[],v=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,g=new RegExp(e.source,v+"g");while(r=a(b,g,n)){if(p=g.lastIndex,p>h&&(j(u,N(n,h,r.index)),r.length>1&&r.index<n.length&&i(x,u,m(r,1)),d=r[0].length,h=p,u.length>=o))break;g.lastIndex===r.index&&g.lastIndex++}return h===n.length?!d&&O(g,"")||j(u,""):j(u,N(n,h)),u.length>o?m(u,0,o):u}:"0".split(void 0,0).length?function(e,s){return void 0===e&&0===s?[]:a(t,this,e,s)}:t,[function(t,s){var i=c(this),o=void 0==t?void 0:v(t,e);return o?a(o,t,i,s):a(n,f(i),t,s)},function(e,i){var a=r(this),o=f(e),l=s(n,a,o,i,n!==t);if(l.done)return l.value;var c=p(a,RegExp),v=a.unicode,m=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(C?"g":"y"),b=new c(C?"^(?:"+a.source+")":a,m),g=void 0===i?w:i>>>0;if(0===g)return[];if(0===o.length)return null===h(b,o)?[o]:[];var y=0,x=0,O=[];while(x<o.length){b.lastIndex=C?0:x;var L,k=h(b,C?N(o,x):o);if(null===k||(L=_(u(b.lastIndex+(C?x:0)),o.length))===y)x=d(o,x,v);else{if(j(O,N(o,y,x)),O.length===g)return O;for(var S=1;S<=k.length-1;S++)if(j(O,k[S]),O.length===g)return O;x=y=L}}return j(O,N(o,y)),O}]}),!L,C)},1293:function(e,t,s){"use strict";s("f2d1")},"15ce":function(e,t,s){"use strict";s("0492")},"32b3":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"box"},[s("page-frame",{attrs:{title:"审批策略",icon:"approvalStrategy"},scopedSlots:e._u([{key:"headBtn",fn:function(){return[s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.showNewStrategy,expression:"!showNewStrategy"}],attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.newStrategy}},[e._v(" 新建策略 ")])]},proxy:!0}])},[e.showNewStrategy?s("div",{staticClass:"newOrEditWrap"},[s("div",{staticClass:"header"},[s("div",{staticClass:"title"},[e._v(e._s(e.newOrEditTitle))]),s("div",{staticClass:"goBack",on:{click:function(t){e.showNewStrategy=!1}}},[s("i",{staticClass:"el-icon-back"}),s("span",[e._v("返回上一级")])])]),s("div",{staticClass:"content"},[s("el-form",{ref:"form",attrs:{"label-width":"100px","label-position":"right",size:"small"}},[s("el-form-item",{attrs:{label:"策略名称"}},[s("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入策略名称"},on:{blur:e.strategyNameExists},model:{value:e.formObj.strategyName,callback:function(t){e.$set(e.formObj,"strategyName",t)},expression:"formObj.strategyName"}})],1),s("el-form-item",{attrs:{label:"应用范围"}},[s("scope-select",{attrs:{setPath:e.setPath,size:"small",width:"300px"},on:{fullPath:e.fullPath},model:{value:e.showScope,callback:function(t){e.showScope=t},expression:"showScope"}})],1),s("el-form-item",{attrs:{label:"审批人"}},[s("div",{staticClass:"approval"},e._l(e.formObj.approvalList,(function(t,i){return s("div",{key:i,staticClass:"approvalWrap"},[1==t.type?s("div",{staticClass:"superior",on:{mouseenter:function(s){return e.setShowEdit(t)},mouseleave:function(s){return e.setHideEdit(t)}}},[t.showEdit?s("div",{staticClass:"EditWrap"},[s("span",{staticClass:"edit",on:{click:function(s){return e.editApproval(t,i)}}},[e._v(" 编辑 ")]),s("span",{staticClass:"del",on:{click:function(t){return e.delApproval(i,1)}}},[e._v(" 删除 ")])]):e._e(),s("div",{staticClass:"approvalBox"},[s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})]),s("span",[e._v(e._s(e.levelObj[t.superior.level]))]),s("span",[e._v(" （"+e._s(e.approvalMode[t.superior.approvalType])+"） ")])])]):e._e(),2==t.type?s("div",{staticClass:"member"},[s("div",{staticClass:"memberWrap",on:{mouseenter:function(s){return e.setShowEdit(t)},mouseleave:function(s){return e.setHideEdit(t)}}},[t.showEdit?s("div",{staticClass:"EditWrap"},[s("span",{staticClass:"edit",on:{click:function(s){return e.editApproval(t,i)}}},[e._v(" 编辑 ")]),s("span",{staticClass:"del",on:{click:function(t){return e.delApproval(i,2)}}},[e._v(" 删除 ")])]):e._e(),e._l(t.member.userList,(function(i,a){return s("div",{key:i.index,staticClass:"content"},[s("div",{staticClass:"memberBox"},[s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})]),s("span",[e._v(e._s(i.userId))])]),a!=t.member.userList.length-1?s("div",{staticClass:"interval"}):e._e()])}))],2),s("div",{staticClass:"memType"},[e._v(" （"+e._s(e.approvalMode[t.member.approvalType])+"） ")])]):e._e(),3==t.type?s("div",{staticClass:"iAm"},[s("div",{staticClass:"approvalBox"},[s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})]),s("span",[e._v("申请人本人")])])]):e._e()])})),0),s("div",{staticClass:"addBox",on:{click:e.clickAddBox}},[s("i",{staticClass:"el-icon-plus"})])])],1)],1),s("div",{staticClass:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveNewOrEdit}},[e._v(" 保存 ")]),s("el-button",{attrs:{type:"info",size:"small"},on:{click:e.cancelCreate}},[e._v(" 取消 ")])],1)]):s("div",{staticClass:"strategyWrap"},[s("div",{staticClass:"tips"},[e._v("提示：优先匹配排序靠前的审批流程")]),e.loading?s("div",{staticStyle:{"margin-top":"15px"}},[s("el-skeleton",{attrs:{rows:e.rows,variant:"rect",animated:""}})],1):s("strategy-item",{attrs:{strategyList:e.strategyList},on:{passSignal:e.passSignal,operation:e.operation}})],1)]),s("new-approval",{attrs:{formObj:e.approvalObj1,editOrNew:e.editOrNew},on:{addApproval:e.addApproval},model:{value:e.showNewApproval,callback:function(t){e.showNewApproval=t},expression:"showNewApproval"}}),s("new-cc",{on:{selectUser:e.selectUser},model:{value:e.showNewCc,callback:function(t){e.showNewCc=t},expression:"showNewCc"}})],1)},a=[],n=(s("d3b7"),s("d81d"),s("b0c0"),s("ac1f"),s("1276"),s("a434"),s("75ba")),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{key:e.testKey,staticClass:"itemBox"},e._l(e.strategyList,(function(t,i){return s("div",{key:t.id,staticClass:"strategyWrap"},[s("div",{staticClass:"strategyBox"},[s("div",{staticClass:"topWrap"},[s("div",{staticClass:"strategyName"},[e._v(" "+e._s(t.strategyName)+" ")]),s("div",{staticClass:"operate"},[s("i",{staticClass:"iconfont icon-bianji",attrs:{title:"编辑"},on:{click:function(s){return e.editItem(t)}}}),s("el-dropdown",{on:{command:e.handleCommand,"visible-change":function(s){return e.visibleChange(t.id)}}},[s("span",[s("i",{staticClass:"iconfont icon-gengduo"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"del"}},[e._v("删除")]),s("el-dropdown-item",{attrs:{command:"up",disabled:0==i}},[e._v(" 上移 ")]),s("el-dropdown-item",{attrs:{command:"down",disabled:i==e.strategyList.length-1}},[e._v(" 下移 ")])],1)],1)],1)]),s("div",{staticClass:"contentWrap"},[s("div",{staticClass:"condition"},[s("div",{staticClass:"label"},[e._v("条件")]),s("div",{staticClass:"content"},[s("span",[e._v("应用范围：")]),s("span",[e._v(e._s(t.scope.split(",")[0].substring(3)))])])]),s("div",{staticClass:"approval"},[s("div",{staticClass:"label"},[e._v("审批人")]),e._l(t.approvalList,(function(t,i){return s("div",{key:i,staticClass:"approvalWrap"},[1==t.type?s("div",{staticClass:"superior"},[s("div",{staticClass:"approvalBox"},[e._m(0,!0),s("span",[e._v(e._s(e.levelObj[t.superior.level]))]),s("span",[e._v(" （"+e._s(e.approvalMode[t.superior.approvalType])+"） ")])])]):e._e(),2==t.type?s("div",{staticClass:"member"},[s("div",{staticClass:"content"},[e._l(t.member.userList,(function(t){return[s("div",{key:t.index},[s("div",{staticClass:"memberBox"},[e._m(1,!0),s("span",[e._v(e._s(t.userId))])])])]}))],2),s("div",{staticClass:"memType"},[e._v(" （"+e._s(e.approvalMode[t.member.approvalType])+"） ")])]):e._e(),3==t.type?s("div",{staticClass:"iAm"},[e._m(2,!0)]):e._e()])}))],2)])])])})),0)},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"approvalBox"},[s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})]),s("span",[e._v("申请人本人")])])}],r={name:"strategyItem",props:{strategyList:Array},data:function(){return{testKey:0,operateId:0,approvalMode:{1:"会签",2:"或签",3:"依次审批"},levelObj:{1:"直接上级",2:"第二级上级",3:"第三级上级",4:"第四级上级",5:"第五级上级",6:"第六级上级"}}},methods:{handleCommand:function(e){var t=this;switch(e){case"del":this.$http("deleteStrategy",{id:this.operateId}).then((function(e){t.$emit("operation",!0),t.$message.success(e.errMsg)}));break;case"up":case"down":this.$http("upOrDown",{id:this.operateId,isUp:"up"==e}).then((function(e){t.$emit("operation",!0),t.$message.success(e.errMsg)}));break}},visibleChange:function(e){this.operateId=e},editItem:function(e){console.log(e),this.$emit("passSignal",!0,e)}}},c=r,p=(s("a983"),s("2877")),d=Object(p["a"])(c,o,l,!1,null,"0c71e755",null),u=d.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"box"},[s("el-dialog",{attrs:{visible:e.tempVal,width:"550px"},on:{"update:visible":function(t){e.tempVal=t},close:e.dialogClose}},[s("template",{slot:"title"},[s("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" 添加审批人 ")])]),s("el-radio-group",{on:{change:e.typeChange},model:{value:e.formObj.type,callback:function(t){e.$set(e.formObj,"type",t)},expression:"formObj.type"}},e._l(e.approvalType,(function(t){return s("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1),s("el-divider"),1==e.formObj.type?s("div",{staticClass:"superior"},[s("div",{staticClass:"level"},[s("div",{staticClass:"label"},[e._v("指定层级")]),s("el-select",{staticStyle:{"margin-right":"10px"},attrs:{size:"small"},model:{value:e.formObj.superior.levelType,callback:function(t){e.$set(e.formObj.superior,"levelType",t)},expression:"formObj.superior.levelType"}},e._l(e.levelTypes,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),s("el-select",{attrs:{size:"small"},model:{value:e.formObj.superior.level,callback:function(t){e.$set(e.formObj.superior,"level",t)},expression:"formObj.superior.level"}},e._l(e.levelList,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("div",{staticClass:"noLevel"},[s("div",{staticClass:"label"},[e._v("当前层级无上级时")]),s("el-checkbox",{model:{value:e.formObj.superior.noSuperior,callback:function(t){e.$set(e.formObj.superior,"noSuperior",t)},expression:"formObj.superior.noSuperior"}},[e._v(" 当前层级无上级时，此审批节点为空，直接跳过由上一级审批 ")])],1)]):e._e(),2==e.formObj.type?s("div",{staticClass:"member"},[s("div",{staticClass:"labelWrap"},[s("span",{staticClass:"label"},[e._v("添加成员")]),s("span",{staticClass:"tips"},[e._v("不能超过100人")])]),s("div",{staticClass:"memberWrap"},[e.formObj.member.userList.length>0?s("div",{staticClass:"content"},[e._l(e.formObj.member.userList,(function(t){return[s("div",{key:t.index,staticClass:"memberBox"},[s("div",{staticClass:"iconBox"},[s("i",{staticClass:"iconfont icon-yonghutianchong"})]),s("span",[e._v(e._s(t.userId))])])]}))],2):e._e(),s("div",{staticClass:"addBox",on:{click:e.addUser}},[s("i",{staticClass:"el-icon-plus"})])])]):e._e(),3!=e.formObj.type?s("el-divider"):e._e(),s("div",{staticClass:"label"},[e._v(" "+e._s(2==e.formObj.type?"多人审批模式":1==e.formObj.type?"同时有多个上级时":"")+" ")]),3!=e.formObj.type?s("el-radio-group",{staticStyle:{width:"150px"},model:{value:e.formObj[e.type].approvalType,callback:function(t){e.$set(e.formObj[e.type],"approvalType",t)},expression:"formObj[type].approvalType"}},e._l(e.approvalMode,(function(t){return s("el-radio",{key:t.value,staticStyle:{margin:"5px 0px"},attrs:{label:t.value,disabled:1==e.formObj.type&&3==t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e(),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v(" 确 定 ")])],1)],2),s("new-cc",{attrs:{userList:e.userList},on:{selectUser:e.selectUser},model:{value:e.showAddMember,callback:function(t){e.showAddMember=t},expression:"showAddMember"}})],1)},v=[],m=(s("a9e3"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"box"},[s("el-dialog",{attrs:{visible:e.tempVal,top:"50px",width:"750px"},on:{"update:visible":function(t){e.tempVal=t},close:e.dialogClose}},[s("template",{slot:"title"},[s("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" 添加成员 ")])]),s("div",{staticClass:"tips"},[e._v("添加指定成员（不超过100人）")]),s("div",{staticClass:"contentBox"},[s("div",{staticClass:"treeWrap"},[s("el-tree",{ref:"tree",attrs:{props:e.props,load:e.loadNode,"show-checkbox":"","node-key":"name",lazy:"","empty-text":"暂无数据"},on:{check:e.nodeCheck},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,a=t.data;return s("span",{staticClass:"nodeItem"},[s("i",{class:"user"==a.type?"iconfont icon-yonghutianchong":"group"==a.type?"iconfont icon-huaban":"iconfont icon-department"}),s("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(i.label))])])}}])})],1),s("div",{staticClass:"seleWrap"},[e._l(e.seleNodeList,(function(t,i){return[s("div",{key:t,staticClass:"seleItem"},[s("i",{staticClass:"iconfont icon-yonghutianchong"}),s("span",[e._v(e._s(t))]),s("i",{staticClass:"el-icon-close",on:{click:function(s){return e.delMember(i,t)}}})])]}))],2)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v(" 确 定 ")])],1)],2)],1)}),h=[],b=(s("caad"),s("2532"),{name:"newCc",props:{type:Number,value:Boolean,userList:Array},data:function(){return{tempVal:!1,seleNodeList:[],props:{label:"name",isLeaf:"leaf"}}},watch:{value:{handler:function(e){this.tempVal=e},immediate:!0},userList:{immediate:!0,handler:function(e){this.seleNodeList=e}}},methods:{loadNode:function(e,t){var s=this,i=0==e.level?"":e.data.dn;this.$http("getDepartmentUserTree",{dn:i}).then((function(e){var i=[];e.data&&e.data.length>0&&e.data.map((function(e){i.push({name:e.name,leaf:!e.hasChild,dn:e.dn,parentDn:e.parentDn,type:e.type})})),t(i),s.userList&&i.map((function(e){s.userList.includes(e.name)&&s.$refs["tree"].setChecked(e.name,!0)}))}))},nodeCheck:function(e,t){var s=this;t.checkedNodes.map((function(e){e.leaf&&!s.seleNodeList.includes(e.name)&&s.seleNodeList.push(e.name)}))},getDepartmentUserTree:function(e){this.$http("getDepartmentUserTree",{dn:e}).then((function(e){return e.data}))},delMember:function(e,t){this.seleNodeList.splice(e,1),this.$refs["tree"].setChecked(t,!1)},cancel:function(){this.$emit("input",!1)},confirm:function(){this.$emit("input",!1),this.$emit("selectUser",this.seleNodeList)},dialogClose:function(){this.$emit("input",!1)}}}),g=b,y=(s("75dc"),Object(p["a"])(g,m,h,!1,null,"7b9bdebe",null)),C=y.exports,w=s("b8f0"),_={name:"newApproval",props:{value:Boolean,formObj:Object,editOrNew:Number},components:{newCc:C},data:function(){return{userList:[],type:"superior",showAddMember:!1,tempVal:!1,approvalType:[{label:"指定上级",value:1},{label:"指定成员",value:2},{label:"申请人本人",value:3}],approvalMode:[{label:"会签（须所有成员同意）",value:1},{label:"或签（一名成员同意即可）",value:2},{label:"依次审批（按顺序依次审批）",value:3}],levelTypes:[{label:"从下到上",value:1},{label:"从上到下",value:2}],levelList:[{label:"直接上级",value:1},{label:"第二级上级",value:2},{label:"第三级上级",value:3},{label:"第四级上级",value:4},{label:"第五级上级",value:5},{label:"第六级上级",value:6}]}},watch:{value:{handler:function(e){this.tempVal=e},immediate:!0},"formObj.type":function(e){this.type=1==e?"superior":"member"}},methods:{selectUser:function(e){this.formObj.member.userList=e.map((function(e,t){return{userId:e,index:t}}))},addUser:function(){this.userList=this.formObj.member.userList.map((function(e){return e.userId})),this.showAddMember=!0},typeChange:function(e){this.type=1==e?"superior":"member"},cancel:function(){this.$emit("input",!1)},confirm:function(){this.$emit("input",!1),this.$emit("addApproval",Object(w["a"])(this.formObj),this.editOrNew)},dialogClose:function(){this.$emit("input",!1)}}},x=_,O=(s("15ce"),Object(p["a"])(x,f,v,!1,null,"2543e24a",null)),j=O.exports,N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-select",{style:{width:e.width||"360px"},attrs:{size:e.size||"small",clearable:""},on:{clear:e.selectClear},model:{value:e.tempVal,callback:function(t){e.tempVal=t},expression:"tempVal"}},[s("template",{slot:"empty"},[s("div",{staticClass:"goBack",attrs:{size:"mini"},on:{click:function(t){return e.goBack(e.depOU)}}},[e._v("向上一级")]),e.depList.length>0?s("div",{staticClass:"depWrap"},e._l(e.depList,(function(t,i){return s("div",{key:t.name,ref:"depItem",refInFor:!0,staticClass:"depItem"},[s("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:"点击获取子部门"},on:{click:function(s){return e.getDepartmentList(t.dn)}}}),s("div",{staticClass:"depName",style:t.style,on:{click:function(t){return e.selectDep(i)}}},[e._v(" "+e._s(t.name)+" ")])])})),0):s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.depLoading,expression:"depLoading"}],staticClass:"noData"},[e._v("暂无数据")])])],2)},L=[],k=s("5530"),S=(s("a15b"),{name:"scopeSelect",props:["value","setPath","size","width"],data:function(){return{depLoading:!1,tempVal:"",depOU:"",selectInfo:{index:-1,dn:""},selectIndex:-1,depList:[],selectedStyle:{color:"#228be6",fontWeight:"600"},normalStyle:{color:"#495057",fontWeight:"normal"}}},watch:{value:{immediate:!0,handler:function(e){this.tempVal=e}},setPath:{immediate:!0,handler:function(e){var t;e&&(t=e.indexOf("OU=")<0?"":e.split(",").splice(1).join(","),this.getDepartmentList(t))}}},mounted:function(){this.getDepartmentList(this.depOU)},methods:{goBack:function(e){if(e){var t=e.indexOf("OU=");-1!=t?(console.log(e),this.getDepartmentList(e.substring(e.indexOf(",")+1))):this.getDepartmentList("")}else this.$message.warning("已无上级")},getDepartmentList:function(e){var t=this;this.depList=[],this.depLoading=!0,this.depOU=e,this.$http("getDepartmentList",{dn:e}).then((function(s){s.data&&(t.depList=s.data.map((function(s,i){return e==t.selectInfo.dn&&i==t.selectInfo.index?Object(k["a"])(Object(k["a"])({},s),{},{style:t.selectedStyle}):Object(k["a"])(Object(k["a"])({},s),{},{style:t.normalStyle})})))})).finally((function(){t.depLoading=!1}))},selectDep:function(e){var t=this;this.depList.map((function(s,i){i==e?(t.selectInfo.index=e,t.selectInfo.dn=t.depOU,t.$set(s,"style",t.selectedStyle),t.$emit("input",s.name),t.$emit("fullPath",s.dn)):t.$set(s,"style",t.normalStyle)}))},selectClear:function(){this.$set(this.depList[this.selectInfo.index],"style",this.normalStyle),this.$emit("fullPath",""),this.selectInfo.index=-1}}}),I=S,$=(s("d655"),Object(p["a"])(I,N,L,!1,null,"4fa0e33f",null)),E=$.exports,T={name:"approvalStrategy",components:{pageFrame:n["a"],strategyItem:u,newApproval:j,newCc:C,scopeSelect:E},data:function(){return{setPath:"",editIndex:-1,showEdit:!0,rows:14,showScope:"",loading:!1,isCreate:!1,showNewStrategy:!1,showNewApproval:!1,showNewCc:!1,newOrEditTitle:"",approvalMode:{1:"会签",2:"或签",3:"依次审批"},levelObj:{1:"直接上级",2:"第二级上级",3:"第三级上级",4:"第四级上级",5:"第五级上级",6:"第六级上级"},approvalObj:{superior:{levelType:1,level:1,noSuperior:!1,approvalType:1},member:{approvalType:1,userList:[]},type:1},approvalObj1:{},formObj:{id:null,scope:"",strategyName:"",strategyType:1,ccList:[],approvalList:[{superior:{levelType:1,level:1,noSuperior:!1,approvalType:1},member:{approvalType:1,userList:[]},type:1}]},strategyList:[],nameUsed:!1,editOrNew:0}},mounted:function(){this.rows=Math.round((document.body.offsetHeight-150)/38),this.getData()},methods:{getData:function(){var e=this;this.loading=!0,this.$http("getApprovalStrategyList").then((function(t){e.strategyList=t.data})).finally((function(){e.loading=!1}))},fullPath:function(e){this.formObj.scope=e},selectUser:function(e){this.formObj.ccList=e.map((function(e){return e.name}))},strategyNameExists:function(){var e=this;this.formObj.strategyName&&this.$http("strategyNameExists",{id:this.formObj.id,strategyName:this.formObj.strategyName}).then((function(t){t.data?(e.$message.warning("该策略名称已存在"),e.nameUsed=!0):e.nameUsed=!1}))},newStrategy:function(){this.newOrEditTitle="新建策略",this.approvalObj1=Object(w["a"])(this.approvalObj),this.isCreate=!0,this.showScope="",this.formObj.strategyType=1,this.formObj.scope="",this.formObj.strategyName="",this.formObj.ccList=[],this.formObj.approvalList=[],this.formObj.id=null,this.showNewStrategy=!0},passSignal:function(e,t){console.log("passSignal",t),this.isCreate=!1,this.setPath=t.scope,this.showNewStrategy=e,this.showScope=t.scope.split(",")[0].substring(3),this.newOrEditTitle="编辑策略",t["strategyType"]=1,this.formObj=Object(w["a"])(t)},operation:function(e){e&&this.getData()},addApproval:function(e,t){console.log(e),2==t?this.formObj.approvalList.push(e):1==e.type?(this.$set(this.formObj.approvalList[this.editIndex].superior,"levelType",e.superior.levelType),this.$set(this.formObj.approvalList[this.editIndex].superior,"level",e.superior.level),this.$set(this.formObj.approvalList[this.editIndex].superior,"noSuperior",e.superior.noSuperior),this.$set(this.formObj.approvalList[this.editIndex].superior,"approvalType",e.superior.approvalType)):(this.$set(this.formObj.approvalList[this.editIndex].member,"approvalType",e.member.approvalType),this.$set(this.formObj.approvalList[this.editIndex].member,"userList",e.member.userList))},saveNewOrEdit:function(){var e=this;if(this.nameUsed)this.$message.warning("该策略名称已存在");else{var t=this.isCreate?"createStrategy":"updateStrategy";console.log(t,this.formObj),this.$http(t,this.formObj).then((function(t){e.$message.success(t.errMsg)})).finally((function(){e.showNewStrategy=!1,e.getData()}))}},cancelCreate:function(){this.showNewStrategy=!1,this.getData()},setShowEdit:function(e){this.$set(e,"showEdit",!0)},setHideEdit:function(e){this.$set(e,"showEdit",!1)},delApproval:function(e){this.formObj.approvalList.splice(e,1)},editApproval:function(e,t){2==e.type&&(e.superior={levelType:1,level:1,noSuperior:!1,approvalType:1}),this.editIndex=t,this.editOrNew=1,this.approvalObj1=Object(w["a"])(e),this.showNewApproval=!0},clickAddBox:function(){this.approvalObj1=Object(w["a"])(this.approvalObj),this.showNewApproval=!0,this.editOrNew=2}}},A=T,B=(s("00fc"),Object(p["a"])(A,i,a,!1,null,"fd727ce0",null));t["default"]=B.exports},"408a":function(e,t,s){var i=s("e330");e.exports=i(1..valueOf)},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,s){var i=s("e330"),a=s("1d80"),n=s("577e"),o=s("5899"),l=i("".replace),r="["+o+"]",c=RegExp("^"+r+r+"*"),p=RegExp(r+r+"*$"),d=function(e){return function(t){var s=n(a(t));return 1&e&&(s=l(s,c,"")),2&e&&(s=l(s,p,"")),s}};e.exports={start:d(1),end:d(2),trim:d(3)}},"75ba":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pageBox"},[s("el-header",{staticStyle:{height:"25px","line-height":"25px"}},[s("i",{class:"iconfont icon-"+e.icon}),s("span",{staticClass:"title"},[e._v(e._s(e.title))]),s("div",{staticClass:"headBtn"},[e._t("headBtn")],2)]),s("el-divider"),s("el-container",[e.aside?s("el-aside",{staticStyle:{"border-right":"0.5px solid #d9d9d9"},attrs:{width:e.asideWidth||"185px"}},[e._t("aside")],2):e._e(),s("el-main",[e._t("default")],2)],1)],1)},a=[],n={name:"pageFrame",props:["aside","title","icon","asideWidth"],data:function(){return{}},created:function(){},methods:{}},o=n,l=(s("1293"),s("2877")),r=Object(l["a"])(o,i,a,!1,null,"4bf95040",null);t["a"]=r.exports},"75dc":function(e,t,s){"use strict";s("b55c")},"7dc5":function(e,t,s){},"81ce":function(e,t,s){},a15b:function(e,t,s){"use strict";var i=s("23e7"),a=s("e330"),n=s("44ad"),o=s("fc6a"),l=s("a640"),r=a([].join),c=n!=Object,p=l("join",",");i({target:"Array",proto:!0,forced:c||!p},{join:function(e){return r(o(this),void 0===e?",":e)}})},a434:function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("23cb"),o=s("5926"),l=s("07fa"),r=s("7b0b"),c=s("65f0"),p=s("8418"),d=s("1dde"),u=d("splice"),f=a.TypeError,v=Math.max,m=Math.min,h=9007199254740991,b="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!u},{splice:function(e,t){var s,i,a,d,u,g,y=r(this),C=l(y),w=n(e,C),_=arguments.length;if(0===_?s=i=0:1===_?(s=0,i=C-w):(s=_-2,i=m(v(o(t),0),C-w)),C+s-i>h)throw f(b);for(a=c(y,i),d=0;d<i;d++)u=w+d,u in y&&p(a,d,y[u]);if(a.length=i,s<i){for(d=w;d<C-i;d++)u=d+i,g=d+s,u in y?y[g]=y[u]:delete y[g];for(d=C;d>C-i+s;d--)delete y[d-1]}else if(s>i)for(d=C-i;d>w;d--)u=d+i-1,g=d+s-1,u in y?y[g]=y[u]:delete y[g];for(d=0;d<s;d++)y[d+w]=arguments[d+2];return y.length=C-i+s,a}})},a983:function(e,t,s){"use strict";s("7dc5")},a9e3:function(e,t,s){"use strict";var i=s("83ab"),a=s("da84"),n=s("e330"),o=s("94ca"),l=s("6eeb"),r=s("1a2d"),c=s("7156"),p=s("3a9b"),d=s("d9b5"),u=s("c04e"),f=s("d039"),v=s("241c").f,m=s("06cf").f,h=s("9bf2").f,b=s("408a"),g=s("58a8").trim,y="Number",C=a[y],w=C.prototype,_=a.TypeError,x=n("".slice),O=n("".charCodeAt),j=function(e){var t=u(e,"number");return"bigint"==typeof t?t:N(t)},N=function(e){var t,s,i,a,n,o,l,r,c=u(e,"number");if(d(c))throw _("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=g(c),t=O(c,0),43===t||45===t){if(s=O(c,2),88===s||120===s)return NaN}else if(48===t){switch(O(c,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+c}for(n=x(c,2),o=n.length,l=0;l<o;l++)if(r=O(n,l),r<48||r>a)return NaN;return parseInt(n,i)}return+c};if(o(y,!C(" 0o1")||!C("0b1")||C("+0x1"))){for(var L,k=function(e){var t=arguments.length<1?0:C(j(e)),s=this;return p(w,s)&&f((function(){b(s)}))?c(Object(t),s,k):t},S=i?v(C):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),I=0;S.length>I;I++)r(C,L=S[I])&&!r(k,L)&&h(k,L,m(C,L));k.prototype=w,w.constructor=k,l(a,y,k)}},b55c:function(e,t,s){},d655:function(e,t,s){"use strict";s("e4f9")},e4f9:function(e,t,s){},f2d1:function(e,t,s){}}]);