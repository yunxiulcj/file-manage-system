(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-285d7242"],{1886:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("div",{staticClass:"contentBox"},[i("header",[i("div",{staticClass:"headLeft"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.addFolderDialog=!0}}},[i("i",{staticClass:"iconfont icon-xinjianwenjian"}),t._v(" 新建文件夹 ")]),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.uploadFile}},[i("i",{staticClass:"iconfont icon-upload"}),t._v(" 上传文件 ")]),i("el-button",{staticStyle:{background:"#0eafc0"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.createApply(t.selectData)}}},[i("i",{staticClass:"iconfont icon-fileDownload"}),t._v(" 下载申请 ")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.selectData.length>0,expression:"selectData.length > 0"}],attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(e){return t.delFile(t.selectData)}}},[i("i",{staticClass:"iconfont icon-delete"}),t._v(" 删除 ")])],1),i("div",{staticClass:"headRight"},[i("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入文件名","suffix-icon":"el-icon-search",size:"small"},model:{value:t.filterName,callback:function(e){t.filterName=e},expression:"filterName"}}),t.isTable?i("i",{staticClass:"iconfont icon-caidan",attrs:{title:"按图标排列"},on:{click:function(e){t.isTable=!1}}}):i("i",{staticClass:"iconfont icon-liebiao",attrs:{title:"按表格排列"},on:{click:function(e){t.isTable=!0}}})],1)]),i("div",{staticClass:"breadCrumbBox"},[i("bread-crumb",{on:{startGetData:t.startGetData},model:{value:t.nowPath,callback:function(e){t.nowPath=e},expression:"nowPath"}})],1),t.isTable?i("div",{staticClass:"tableWrap"},[i("table-temp",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{config:t.tableConfig},on:{"selection-change":t.handleSelectionChange,cellMouseEnter:t.cellMouseEnter,cellMouseLeave:t.cellMouseLeave},scopedSlots:t._u([{key:"file",fn:function(e){return[i("div",{staticClass:"fileWrap"},[e.row.dir?i("div",{staticClass:"fileIcon",style:{background:"url("+t.iconPath.folder+")",backgroundSize:"100% 100%"}}):i("div",{staticClass:"fileIcon",style:{background:"url("+t.iconPath.file+")",backgroundSize:"100% 100%"}}),i("div",{staticClass:"fileName"},[e.row.isEdit?i("el-input",{ref:"editInput",attrs:{placeholder:"请输入文件名",size:"mini"},model:{value:e.row.tempName,callback:function(i){t.$set(e.row,"tempName",i)},expression:"scope.row.tempName"}},[i("el-button",{attrs:{slot:"append"},on:{click:function(i){return t.editFileName(e.row)}},slot:"append"},[i("i",{staticClass:"el-icon-check"})])],1):i("span",{class:{clickable:e.row.dir},attrs:{title:e.row.name},on:{click:function(i){e.row.dir&&t.getData(e.row.path)}}},[t._v(" "+t._s(e.row.name)+" ")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.row.showOperate,expression:"scope.row.showOperate"}],staticClass:"operate"},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.row.isEdit,expression:"!scope.row.isEdit"}],staticClass:"iconfont icon-edit",attrs:{title:"编辑"},on:{click:function(i){return i.stopPropagation(),t.showEditName(e.row)}}}),i("i",{directives:[{name:"show",rawName:"v-show",value:e.row.isEdit,expression:"scope.row.isEdit"}],staticClass:"iconfont icon-quxiao",attrs:{title:"取消编辑"},on:{click:function(i){return t.cancelEdit(e.row)}}}),i("i",{directives:[{name:"show",rawName:"v-show",value:!e.row.dir,expression:"!scope.row.dir"}],staticClass:"iconfont icon-xiazai",attrs:{title:"下载"},on:{click:function(i){return i.stopPropagation(),t.createApply([e.row])}}}),i("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"#fa5252",title:"删除后不可恢复，确定删除吗？"},on:{confirm:function(i){return t.confirmDel(e.row)},cancel:function(i){return t.cancelDel(e.row)}}},[i("i",{staticClass:"iconfont icon-trash",style:{color:t.tempDelId==e.row.id?"#fa5252":"#339af0"},attrs:{slot:"reference",title:"删除"},on:{click:function(i){i.stopPropagation(),t.tempDelId=e.row.id}},slot:"reference"})])],1)])]}}],null,!1,3768416430)})],1):i("div",{staticClass:"isIconWrap"},[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v(" 全选 ")]),i("el-divider"),i("div",{staticClass:"fileWrap"},[t._l(t.tableConfig.tableData,(function(e,a){return[i("el-tooltip",{key:a,attrs:{effect:"dark",placement:"top","open-delay":400}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",[t._v("文件名称："+t._s(e.name))]),i("div",[t._v("文件大小："+t._s(e.size))]),i("div",[t._v("修改日期："+t._s(e.lastModified))])]),i("div",{staticClass:"fileBox",class:{checked:e.checked},on:{click:function(i){return t.selectedFile(e)}}},[e.checked?i("i",{staticClass:"el-icon-success"}):t._e(),i("div",{staticClass:"fileIcon"}),i("div",{staticClass:"fileName"},[t._v(t._s(e.name))])])])]}))],2)],1)]),i("el-dialog",{attrs:{visible:t.addFolderDialog,width:"30%"},on:{"update:visible":function(e){t.addFolderDialog=e}}},[i("template",{slot:"title"},[i("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 新建文件夹 ")])]),i("span",[t._v("文件夹名称")]),i("el-input",{staticStyle:{"margin-top":"5px"},attrs:{size:"small",placeholder:"请输入文件夹名称"},model:{value:t.folderName,callback:function(e){t.folderName=e},expression:"folderName"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.addFolderDialog=!1}}},[t._v(" 取 消 ")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.createDirectory}},[t._v(" 确 定 ")])],1)],2),i("upload-dialog",{on:{goGetData:t.goGetData},model:{value:t.uploadDialog,callback:function(e){t.uploadDialog=e},expression:"uploadDialog"}})],1)},s=[],l=(i("4de4"),i("d3b7"),i("b0c0"),i("d81d"),i("8efb")),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"box"},[i("el-dialog",{attrs:{visible:t.tempVal,width:"550px",top:"4%"},on:{"update:visible":function(e){t.tempVal=e},close:t.dialogClose}},[i("template",{slot:"title"},[i("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 文件上传 ")])]),i("div",{staticClass:"fileTreeWrap"},[i("el-tree",{ref:"tree",staticStyle:{width:"300px"},attrs:{props:t.props,load:t.loadNode,"node-key":"label",lazy:"","empty-text":"暂无数据"},on:{"node-click":t.nodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node;return i("span",{staticClass:"nodeItem"},[i("span",{staticStyle:{"font-size":"13px"},attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(a.label)+" ")])])}}])})],1),i("div",{staticClass:"pathBox"},[t._v("目标路径："+t._s(t.targetPath))]),i("el-divider"),i("div",{staticClass:"uploadWrap"},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-remove":t.handleRemove,"show-file-list":!1,"auto-upload":!1,"on-change":t.onUploadChange,"http-request":t.uploadFile,"file-list":t.fileList,multiple:""}},[i("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[t._v(" 选取文件 ")]),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"success",disabled:t.fileList.length<=0},on:{click:t.submitUpload}},[t._v(" 上传到服务器 ")])],1),i("div",{staticClass:"fileList"},t._l(t.fileList,(function(e,a){return i("div",{key:e.uid,staticClass:"fileItem"},[i("div",{staticClass:"fileName"},[t._v(t._s(e.name))]),i("div",{staticClass:"fileSize"},[t._v(t._s(e.size))]),e.loading?i("div",{staticClass:"loading"},[t._v("上传中...")]):i("div",{staticClass:"fileState"},["ready"==e.status?i("i",{staticClass:"el-icon-close",on:{click:function(i){return t.delUploadFile(e,a)}}}):t._e(),"error"==e.status?i("i",{staticClass:"el-icon-warning"}):t._e(),"success"==e.status?i("i",{staticClass:"el-icon-success"}):t._e()])])})),0)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("关 闭")])],1)],2)],1)},o=[],c=(i("a434"),i("bc3a")),r=i.n(c),d=i("b8f0"),f={name:"uploadDialog",props:{value:Boolean},data:function(){return{tempVal:!1,uploadUrl:"",targetPath:"",props:{label:"name",isLeaf:"leaf"},fileList:[],rootPath:"",baseUrl:""}},created:function(){this.baseUrl=this.$store.getters.symSetting.uploadUrl,this.fileList=[]},watch:{value:{handler:function(t){this.tempVal=t},immediate:!0}},methods:{loadNode:function(t,e){var i=0==t.level?"":t.data.path;this.$http("getFileList",{path:i}).then((function(t){var i=[];t.data.map((function(t){t.dir&&i.push({name:t.name,path:t.path,leaf:!t.dir})})),e(i)}))},nodeClick:function(t){console.log(this.$refs.tree.getCurrentKey),this.targetPath!=t.path?this.targetPath=t.path:this.targetPath="/"},uploadFile:function(t){var e=this,i=t.file,a=0,s=new FormData;s.append("file",i,i.name),this.fileList.map((function(t,s){t.uid==i.uid&&(e.$set(t,"loading",!0),a=s)})),this.$http("createToken",{path:this.targetPath,fileName:i.name,type:1}).then((function(t){r.a.post(e.baseUrl+"upload?token="+t.data,s,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){0==t.data.errCode?(e.$set(e.fileList[a],"status","success"),e.$set(e.fileList[a],"loading",!1)):(e.$set(e.fileList[a],"status","error"),e.$set(e.fileList[a],"loading",!1))}))}))},onUploadChange:function(t){var e=!1;t.size=Object(d["d"])(t.size),this.fileList.map((function(i){i.uid==t.uid&&(i=t,e=!0)})),e||this.fileList.push(t)},delUploadFile:function(t,e){console.log(t,e),this.fileList.splice(e,1)},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){console.log(t,e)},handleNodeClick:function(t){this.targetPath=t.label,console.log(t)},cancel:function(){this.$emit("input",!1),this.$emit("goGetData",!0),this.targetPath="/",this.fileList=[]},dialogClose:function(){this.$emit("input",!1),this.$emit("goGetData",!0),this.targetPath="/",this.fileList=[]}}},u=f,p=(i("8294"),i("2877")),h=Object(p["a"])(u,n,o,!1,null,"1b24ac56",null),m=h.exports,g=i("2c4e"),v={name:"soFile",components:{tableTemp:l["a"],uploadDialog:m,breadCrumb:g["a"]},data:function(){return{iconPath:{file:i("f3d3"),folder:i("589a")},filterName:"",fullData:[],tempDelId:"",folderName:"",selectedList:[],isIndeterminate:!0,uploadDialog:!1,addFolderDialog:!1,nowPath:"",checkAll:!1,isTable:!0,tableLoading:!1,tableConfig:{tableData:[],maxHeight:"10000px",selection:!0,stripe:!1,border:!1,headerCellStyle:{background:"#f7f9fd",height:"35px",lineHeight:"35px",fontSize:"15px"},tableSetting:[{prop:"name",label:"文件名",align:"left",slot:"file",minWidth:"400px"},{prop:"size",label:"大小",formatter:function(t){return t.dir?"-":Object(d["d"])(t.size)}},{prop:"lastModified",label:"修改日期"}]},selectData:[]}},created:function(){},mounted:function(){this.tableConfig.maxHeight=document.body.clientHeight-220+"px",this.getData(this.nowPath)},watch:{filterName:function(t){this.$set(this.tableConfig,"tableData",this.fullData.filter((function(e){if(-1!=e.name.indexOf(t))return e})))}},methods:{createApply:function(t){var e=t.map((function(t){return{fileSize:t.size,filePath:t.path,fileName:t.name,size:Object(d["d"])(t.size)}})),i={applyUser:localStorage.getItem("username")||"",applyEmail:"",applyTheme:"",describe:"",applyType:1,downloadDay:1,downloadCount:1,fileList:e,approvalUserList:[]};this.$router.push({name:"newOrEditApply",params:{type:0,data:i}})},createDirectory:function(){var t=this;this.folderName?this.$http("createDirectory",{fileName:this.folderName,path:this.nowPath}).then((function(e){t.$message.success(e.errMsg)})).finally((function(){t.addFolderDialog=!1,t.getData(t.nowPath)})):this.$message.warning("文件夹名称不能为空")},startGetData:function(t){t&&this.getData(this.nowPath)},getData:function(t){var e,i=this;this.tableLoading=!0,e=t?"/"==t[t.length-1]?t:t+"/":"/",this.$http("getFileList",{path:e}).then((function(t){i.tableConfig.tableData=t.data,i.fullData=t.data,i.nowPath=e})).finally((function(){i.tableLoading=!1}))},confirmDel:function(t){this.delFile([t]),this.tempDelId="",this.$set(t,"showOperate",!1)},cancelDel:function(t){this.tempDelId="",this.$set(t,"showOperate",!1)},handleCheckAllChange:function(t){console.log(t)},selectedFile:function(t){t.checked?this.$set(t,"checked",!1):this.$set(t,"checked",!0)},clickDel:function(t){var e=this,i=t.map((function(t){return t.path}));this.$confirm("删除后不可恢复，是否删除所选文件？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){e.delFile(i)}))},delFile:function(t){var e=this;t.map((function(i,a){e.$http("delete",{path:e.nowPath,fileName:i.dir?i.name+"/":i.name}).then((function(i){a==t.length-1&&(e.getData(e.nowPath),e.$message.success(i.errMsg))}))}))},showEditName:function(t){this.$set(t,"tempName",t.name),this.$set(t,"isEdit",!0)},goGetData:function(t){t&&this.getData(this.nowPath)},editFileName:function(t){var e=this;""!=t.tempName?this.$http("rename",{newName:t.tempName,path:this.nowPath,fileName:t.name}).then((function(t){e.$message.success(t.errMsg),e.getData(e.nowPath)})).finally((function(){e.$set(t,"isEdit",!1)})):this.$message.warning("文件名不能为空")},cancelEdit:function(t){this.$set(t,"isEdit",!1)},uploadFile:function(){this.uploadDialog=!0},handleSelectionChange:function(t){this.selectData=t},cellMouseEnter:function(t){this.$set(t,"showOperate",!0)},cellMouseLeave:function(t){this.tempDelId!=t.id&&this.$set(t,"showOperate",!1)}}},b=v,w=(i("7b6a"),Object(p["a"])(b,a,s,!1,null,"23b0bb5c",null));e["default"]=w.exports},"4b4c":function(t,e,i){},"589a":function(t,e,i){t.exports=i.p+"static/img/folder.83b61646.png"},"59dd":function(t,e,i){},"7b6a":function(t,e,i){"use strict";i("59dd")},8294:function(t,e,i){"use strict";i("4b4c")},f3d3:function(t,e,i){t.exports=i.p+"static/img/file.b6a1d726.png"}}]);