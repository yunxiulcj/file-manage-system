(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0df65288"],{"0147":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"},[n("page-frame",{attrs:{title:"管理员配置",icon:"adminConfig"}},[n("div",{staticClass:"btnWrap"},[n("div",{staticClass:"leftBtn"},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showNew}},[e._v(" 添加账号 ")]),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteManager(e.delAccount)}}},[e._v(" 删除勾选账号 ")])],1),n("div",{staticClass:"rightBtn"},[n("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.powerPreview}},[e._v(" 权限预览 ")]),n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.getData}},[e._v(" 刷新列表 ")])],1)]),n("table-temp",{ref:"table",attrs:{config:e.tableConfig,loading:e.tableLoading},on:{"selection-change":e.handleSelectionChange}})],1),n("el-dialog",{attrs:{visible:e.showNewOrEdit,width:"500px"},on:{"update:visible":function(t){e.showNewOrEdit=t}}},[n("template",{slot:"title"},[n("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" "+e._s(e.newOrEdit)+" ")])]),n("el-form",{ref:"form",staticStyle:{width:"400px"},attrs:{model:e.formObj,rules:e.formRules,size:"small","label-position":"right","label-width":"100px"}},[n("el-form-item",{attrs:{label:"域账号",prop:"userId"}},[n("el-input",{attrs:{placeholder:"请输入域账号",clearable:""},model:{value:e.formObj.userId,callback:function(t){e.$set(e.formObj,"userId",t)},expression:"formObj.userId"}})],1),n("el-form-item",{attrs:{label:"真实姓名"}},[n("el-input",{attrs:{placeholder:"请输入真实姓名",clearable:""},model:{value:e.formObj.username,callback:function(t){e.$set(e.formObj,"username",t)},expression:"formObj.username"}})],1),n("el-form-item",{attrs:{label:"用户角色"}},[n("el-select",{staticStyle:{width:"300px"},model:{value:e.formObj.roleId,callback:function(t){e.$set(e.formObj,"roleId",t)},expression:"formObj.roleId"}},e._l(e.roleType,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",{attrs:{label:"邮箱"}},[n("el-input",{attrs:{placeholder:"请输入邮箱",clearable:""},model:{value:e.formObj.email,callback:function(t){e.$set(e.formObj,"email",t)},expression:"formObj.email"}})],1),n("el-form-item",{attrs:{label:"手机号码"}},[n("el-input",{attrs:{placeholder:"请输入手机号码",clearable:""},model:{value:e.formObj.phone,callback:function(t){e.$set(e.formObj,"phone",t)},expression:"formObj.phone"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(t){e.showNewOrEdit=!1}}},[e._v("取 消")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.NewOrEditUser}},[e._v(" 确 定 ")])],1)],2),n("el-dialog",{attrs:{visible:e.previewDialog},on:{"update:visible":function(t){e.previewDialog=t}}},[n("template",{slot:"title"},[n("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" 权限预览 ")])]),n("div",{staticClass:"leftBox"}),n("div",{staticClass:"rightBox"}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(t){e.previewDialog=!1}}},[e._v("关 闭")])],1)],2)],1)},o=[],a=(n("d3b7"),n("d81d"),n("75ba")),l=n("8efb"),s={name:"adminConfig",components:{pageFrame:a["a"],tableTemp:l["a"]},data:function(){var e=this,t=function(t,n,i){if(!n)return i(new Error("域账号不能为空"));e.$http("domainAccountMatch",{userId:n}).then((function(e){-1!=e.errCode?i(new Error(e.errMsg)):i()}))};return{normalData:[],newOrEdit:"",showNewOrEdit:!1,tableLoading:!1,delAccount:[],formObj:{userId:"",username:"",roleId:"1",email:"",phone:""},formRules:{userId:[{required:!0,validator:t,trigger:"blur"}]},roleType:[{label:"系统管理员",value:1},{label:"普通管理员",value:2}],tableConfig:{tableData:[],selection:!0,border:!0,tableSetting:[{prop:"userId",label:"域账号"},{prop:"username",label:"真实姓名"},{prop:"roleId",label:"角色",formatter:function(e){return 1==e.roleId?"系统管理员":"普通管理员"}},{prop:"email",label:"邮箱"},{prop:"phone",label:"手机号码"}],operation:{btns:[{label:"修改",type:"text",fn:function(t){e.newOrEdit="编辑账号",e.formObj.userId=t.userId,e.formObj.username=t.username,e.formObj.roleId=t.roleId,e.formObj.email=t.email,e.formObj.phone=t.phone,e.formObj["id"]=t.id,e.showNewOrEdit=!0}},{label:"删除",style:{color:"red"},type:"text",fn:function(t){e.deleteManager([t.id])}}]},map:{data:"data.data",total:"data.totalCount"},page:{pageIndex:1,pageSize:10,pageSizes:[10,20,30,40],total:0,map:{index:"page",size:"pageSize"}},fetchUrl:"getAccountList"},previewDialog:!1}},mounted:function(){this.getData()},methods:{getData:function(){this.$refs.table.fetch()},powerPreview:function(){this.previewDialog=!0},showNew:function(){this.newOrEdit="新建账号",this.formObj["id"]="",this.formObj.userId="",this.formObj.username="",this.formObj.roleId=1,this.formObj.email="",this.formObj.phone="",this.showNewOrEdit=!0},NewOrEditUser:function(){var e=this;this.$refs["form"].validate((function(t){t&&e.$http("saveAccount",e.formObj).then((function(t){e.$message.success(t.errMsg)})).finally((function(){e.showNewOrEdit=!1,e.getData()}))}))},handleSelectionChange:function(e){this.delAccount=e.map((function(e){return e.id}))},deleteManager:function(e){var t=this;e&&e.length>0?this.$confirm("是否删除所选账号？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"error",center:!0}).then((function(){t.$http("deleteAccount",{idList:e}).then((function(e){t.$message.success(e.errMsg)})).finally((function(){t.getData()}))})):this.$message.info("请勾选删除的账号")}}},r=s,c=(n("aa8b"),n("2877")),f=Object(c["a"])(r,i,o,!1,null,"d779d6bc",null);t["default"]=f.exports},"0e09":function(e,t,n){},1276:function(e,t,n){"use strict";var i=n("2ba4"),o=n("c65b"),a=n("e330"),l=n("d784"),s=n("44e7"),r=n("825a"),c=n("1d80"),f=n("4840"),g=n("8aa5"),h=n("50c4"),d=n("577e"),p=n("dc4a"),u=n("4dae"),m=n("14c3"),b=n("9263"),C=n("9f7f"),w=n("d039"),v=C.UNSUPPORTED_Y,x=4294967295,y=Math.min,O=[].push,I=a(/./.exec),S=a(O),_=a("".slice),j=!w((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));l("split",(function(e,t,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var a=d(c(this)),l=void 0===n?x:n>>>0;if(0===l)return[];if(void 0===e)return[a];if(!s(e))return o(t,a,e,l);var r,f,g,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,C=new RegExp(e.source,p+"g");while(r=o(b,C,a)){if(f=C.lastIndex,f>m&&(S(h,_(a,m,r.index)),r.length>1&&r.index<a.length&&i(O,h,u(r,1)),g=r[0].length,m=f,h.length>=l))break;C.lastIndex===r.index&&C.lastIndex++}return m===a.length?!g&&I(C,"")||S(h,""):S(h,_(a,m)),h.length>l?u(h,0,l):h}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var i=c(this),l=void 0==t?void 0:p(t,e);return l?o(l,t,i,n):o(a,d(i),t,n)},function(e,i){var o=r(this),l=d(e),s=n(a,o,l,i,a!==t);if(s.done)return s.value;var c=f(o,RegExp),p=o.unicode,u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(v?"g":"y"),b=new c(v?"^(?:"+o.source+")":o,u),C=void 0===i?x:i>>>0;if(0===C)return[];if(0===l.length)return null===m(b,l)?[l]:[];var w=0,O=0,I=[];while(O<l.length){b.lastIndex=v?0:O;var j,k=m(b,v?_(l,O):l);if(null===k||(j=y(h(b.lastIndex+(v?O:0)),l.length))===w)O=g(l,O,p);else{if(S(I,_(l,w,O)),I.length===C)return I;for(var $=1;$<=k.length-1;$++)if(S(I,k[$]),I.length===C)return I;O=w=j}}return S(I,_(l,w)),I}]}),!j,v)},1293:function(e,t,n){"use strict";n("f2d1")},"190f":function(e,t,n){"use strict";n("0e09")},"75ba":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pageBox"},[n("el-header",{staticStyle:{height:"25px","line-height":"25px"}},[n("i",{class:"iconfont icon-"+e.icon}),n("span",{staticClass:"title"},[e._v(e._s(e.title))]),n("div",{staticClass:"headBtn"},[e._t("headBtn")],2)]),n("el-divider"),n("el-container",[e.aside?n("el-aside",{staticStyle:{"border-right":"0.5px solid #d9d9d9"},attrs:{width:e.asideWidth||"185px"}},[e._t("aside")],2):e._e(),n("el-main",[e._t("default")],2)],1)],1)},o=[],a={name:"pageFrame",props:["aside","title","icon","asideWidth"],data:function(){return{}},created:function(){},methods:{}},l=a,s=(n("1293"),n("2877")),r=Object(s["a"])(l,i,o,!1,null,"4bf95040",null);t["a"]=r.exports},"8efb":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"tableTempWrap",staticClass:"table-temp"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.innerLoading,expression:"innerLoading"}],ref:"elTable",staticClass:"farm-table-temp",attrs:{"max-height":e.cloneConfig.maxHeight,loadingText:"正在加载表格数据","empty-text":e.emptyText,data:e.cloneConfig.tableData,"header-cell-style":e.cloneConfig.headerCellStyle,border:e.cloneConfig.border,"row-key":e.cloneConfig.rowKey,lazy:"","default-sort":e.cloneConfig.defaultSort,load:e.cloneConfig.loadFn,stripe:"undefined"==typeof e.cloneConfig.stripe||e.cloneConfig.stripe,size:"small"},on:{"row-click":e.rowClick,"expand-change":e.expandChange,"selection-change":e.handleSelectionChange,"sort-change":e.handleSortChange,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"cell-click":e.cellClick,toggleRowSelection:e.toggleRowSelection}},[e.cloneConfig.selection?n("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}):e._e(),e.cloneConfig.serialNumber?n("el-table-column",{attrs:{type:"index",align:"center",width:"55"}}):e._e(),e.cloneConfig.expand?n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("expand",null,{row:t.row,index:t.$index})]}}],null,!0)}):e._e(),e._l(e.cloneConfig.tableSetting,(function(t,i){return n("el-table-column",{key:i,staticClass:"column",attrs:{label:t.label,prop:t.prop,align:t.align||"center","min-width":t.minWidth||120,width:t.width,fixed:t.fixed,"show-overflow-tooltip":"",filters:t.filters,"filter-method":t.filterMethod,sortable:t.sortable||!1},scopedSlots:e._u([{key:"default",fn:function(o){return[e._t(t.slot,(function(){return[n("span",{directives:[{name:"show",rawName:"v-show",value:"function"===typeof t.show?t.show(o.row):!1!==t.show,expression:"\n              typeof item.show === 'function'\n                ? item.show(scope.row)\n                : item.show === false\n                ? false\n                : true\n            "}],style:t.style?"function"===typeof t.style?t.style(o.row):t.style:{},attrs:{title:t.title},on:{click:function(e){!t.click||("function"===typeof t.click?t.click(o.row):t.click)}}},[e._v(" "+e._s("function"===typeof t.formatter?t.formatter(o.row,o.column,o.row[t.prop],i):o.row[t.prop])+" ")])]}),{row:o.row})]}}],null,!0)})})),e.cloneConfig.operation?n("el-table-column",{attrs:{align:"center",fixed:e.cloneConfig.operation.fixed||"right",label:e.cloneConfig.operation.label||"操作","min-width":e.cloneConfig.operation.minWidth||150,width:e.cloneConfig.operation.width},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("btn",(function(){return e._l(e.cloneConfig.operation.btns,(function(i,o){return n("el-button",{directives:[{name:"show",rawName:"v-show",value:"function"===typeof i.show?i.show(t.row):!1!==i.show,expression:"\n              typeof item.show === 'function'\n                ? item.show(scope.row)\n                : item.show === false\n                ? false\n                : true\n            "}],key:o,attrs:{disabled:!!i.disabled&&("function"===typeof i.disabled?i.disabled(t.row):!1!==i.disabled),size:i.size||"mini",type:i.type||"text"},on:{click:function(e){return i.fn(t.row)}}},[i.href?n("a",{style:"function"===typeof i.style?i.style(t.row):i.style,attrs:{href:i.href}},[e._v(" "+e._s("function"===typeof i.label?i.label(t.row):i.label)+" ")]):n("span",{style:"function"===typeof i.style?i.style(t.row):i.style},[e._v(" "+e._s("function"===typeof i.label?i.label(t.row):i.label)+" ")])])}))}),{row:t.row})]}}],null,!0)}):e._e()],2),e.cloneConfig.page?n("div",{ref:"reportNav",staticClass:"report-nav"},[n("el-pagination",{attrs:{"current-page":e.cloneConfig.page.pageIndex,"page-size":e.cloneConfig.page.pageSize,"page-sizes":e.cloneConfig.page.pageSizes,layout:e.layout,total:e.cloneConfig.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.cloneConfig.page,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.cloneConfig.page,"pageIndex",t)}}})],1):e._e()],1)},o=[],a=n("5530"),l=(n("d81d"),n("d3b7"),n("ac1f"),n("1276"),n("fb6a"),n("b8f0")),s=n("5c96"),r={name:"TableTemp",props:Object(a["a"])({config:{type:Object,require:!0},loading:{type:Boolean,default:!1}},s["Table"].props),watch:{"config.tableData":function(){this.init()}},data:function(){return{sortAble:!1,responseData:null,showSelectList:!1,cloneConfig:{map:{data:"data.items",total:"data.total"},resetIndex:!0},layout:"prev, pager, next, jumper",clientMaxHeight:200,isSizeOrIndexChange:!1,innerLoading:!1}},methods:{handleSortChange:function(e){this.sortAble=!0,this.$emit("sortChange",e)},cellMouseEnter:function(e){this.$emit("cellMouseEnter",e)},cellMouseLeave:function(e){this.$emit("cellMouseLeave",e)},toggleRowSelection:function(e){this.$emit("toggleRowSelection",e)},cellClick:function(e,t,n){this.$emit("cellClick",e,t,n)},getLayout:function(){this.cloneConfig.page&&this.cloneConfig.page.pageSizes&&(this.layout="sizes, "+this.layout),this.cloneConfig.page&&(0===this.cloneConfig.page.total||this.cloneConfig.page.total)&&(this.layout="total, "+this.layout)},handleSelectionChange:function(e){this.$emit("selection-change",e)},handleSizeChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageSize=e,this.cloneConfig.page.pageIndex=1,this.isSizeOrIndexChange=!0),"undefined"!==this.cloneConfig.fetchUrl?this.fetch():this.splitData()},handleCurrentChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=e,this.isSizeOrIndexChange=!0),"undefined"!==this.cloneConfig.fetchUrl?this.fetch():this.splitData()},fetch:function(e){var t,n,i=this;if(this.cloneConfig.fetchUrl)try{!this.cloneConfig.resetIndex&&this.sortAble||this.resetIndex();var o=Object(a["a"])({},this.cloneConfig.condition);if(this.cloneConfig.page){var l="pageSize",s="pageIndex";this.cloneConfig.page.map&&(l=this.cloneConfig.page.map.size||"pageSize",s=this.cloneConfig.page.map.index||"pageIndex"),o[l]=this.cloneConfig.page.pageSize||15,o[s]=this.cloneConfig.page.pageIndex||1}this.innerLoading=!0,this.$emit("update:loading",!0),void 0!=e&&"get"==e&&(o.methodName=e),this.cloneConfig.map&&this.cloneConfig.map.ContentType?(t=this.cloneConfig.map.ContentType,n=this.$http(this.config.fetchUrl,o,{headers:{"Content-Type":t}})):n=this.$http(this.config.fetchUrl,o),n.then((function(e){i.responseData=e;var t=i.dataMap(e,i.cloneConfig.map.data)||[];if(i.cloneConfig.dataProcess&&(t=i.cloneConfig.dataProcess(t)),i.cloneConfig.tableData=t,i.config.tableData=t,i.config.page&&(0===i.config.page.total||i.config.page.total)){var n=i.dataMap(e,i.cloneConfig.map.total)||0;i.cloneConfig.page&&i.$set(i.cloneConfig.page,"total",n)}}),(function(){i.clearData()})).finally((function(){i.$emit("afterFetch",i.responseData),i.$emit("update:loading",!1),i.innerLoading=!1})),this.sortAble=!1}catch(r){this.innerLoading=!1,this.$emit("update:loading",!1),console.log("%c%s","color: red",r)}else console.log("%c没有fetchUrl，请检查","color: red")},clearData:function(){this.cloneConfig.tableData=[],this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=1)&&(this.cloneConfig.page.total=0)},dataMap:function(e,t){try{var n=t.split("."),i=Object(l["a"])(e);while(n.length>0)i=i[n.shift()];return i}catch(o){console.log("数据映射出错%c%s","color: red",o)}},rowClick:function(e,t,n){this.$emit("row-click",e,t,n)},expandChange:function(e,t){this.$emit("expand-change",e,t)},resetIndex:function(){this.cloneConfig.page&&!this.isSizeOrIndexChange?(this.$set(this.cloneConfig.page,"pageIndex",1),this.isSizeOrIndexChange=!1):this.isSizeOrIndexChange=!1},getMaxHeight:function(){var e=this.$refs.tableTempWrap,t=this.$refs.reportNav;this.clientMaxHeight=e.clientHeight-(t?t.offsetHeight:0)},splitData:function(){var e=this.cloneConfig.page&&this.cloneConfig.page.pageIndex||1,t=this.cloneConfig.page&&this.cloneConfig.page.pageSize||15,n=this.config.tableData.length>t?t:this.config.tableData.length;this.cloneConfig.tableData=this.config.tableData.slice((e-1)*t,(e-1)*t+n),this.config.page&&(this.cloneConfig.page.total=this.config.tableData.length)},init:function(){"undefined"===typeof this.config.fetchUrl&&this.config.page?(this.cloneConfig=Object(l["a"])(this.config),this.splitData()):this.cloneConfig=Object(l["b"])(this.config,this.cloneConfig),this.loading&&(this.innerLoading=this.loading)}},created:function(){this.init(),this.getLayout()},mounted:function(){}},c=r,f=(n("190f"),n("2877")),g=Object(f["a"])(c,i,o,!1,null,"7fae086a",null);t["a"]=g.exports},a6e6:function(e,t,n){},aa8b:function(e,t,n){"use strict";n("a6e6")},f2d1:function(e,t,n){}}]);