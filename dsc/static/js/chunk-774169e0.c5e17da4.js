(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-774169e0"],{1293:function(t,a,e){"use strict";e("f2d1")},"1fd7":function(t,a,e){"use strict";e("d8cb")},"75ba":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pageBox"},[e("el-header",{staticStyle:{height:"25px","line-height":"25px"}},[e("i",{class:"iconfont icon-"+t.icon}),e("span",{staticClass:"title"},[t._v(t._s(t.title))]),e("div",{staticClass:"headBtn"},[t._t("headBtn")],2)]),e("el-divider"),e("el-container",[t.aside?e("el-aside",{staticStyle:{"border-right":"0.5px solid #d9d9d9"},attrs:{width:t.asideWidth||"185px"}},[t._t("aside")],2):t._e(),e("el-main",[t._t("default")],2)],1)],1)},l=[],s={name:"pageFrame",props:["aside","title","icon","asideWidth"],data:function(){return{}},created:function(){},methods:{}},o=s,n=(e("1293"),e("2877")),r=Object(n["a"])(o,i,l,!1,null,"4bf95040",null);a["a"]=r.exports},d8cb:function(t,a,e){},e87a:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"box"},[e("page-frame",{attrs:{title:"新建下载申请",icon:"fileDownload"},scopedSlots:t._u([{key:"headBtn",fn:function(){return[e("div",{staticClass:"goBack",on:{click:t.goBack}},[e("i",{staticClass:"el-icon-back"}),e("span",[t._v("返回上一级")])])]},proxy:!0}])},[e("div",{staticClass:"apply"},[e("div",{staticClass:"applyForm"},[e("el-form",{ref:"applyForm",staticStyle:{width:"95%"},attrs:{"label-width":"100px","label-position":"right",size:"small",model:t.applyForm,rules:t.formRule}},[e("el-form-item",{attrs:{label:"申请人"}},[e("div",{staticClass:"applyUser"},[t._v(t._s(t.applyForm.applyUser))])]),e("el-form-item",{attrs:{label:"申请人邮箱",prop:"applyEmail"}},[e("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:t.applyForm.applyEmail,callback:function(a){t.$set(t.applyForm,"applyEmail",a)},expression:"applyForm.applyEmail"}})],1),e("el-form-item",{attrs:{label:"主题",prop:"applyTheme"}},[e("el-input",{attrs:{placeholder:"请输入主题"},model:{value:t.applyForm.applyTheme,callback:function(a){t.$set(t.applyForm,"applyTheme",a)},expression:"applyForm.applyTheme"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"describe"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入申请描述"},model:{value:t.applyForm.describe,callback:function(a){t.$set(t.applyForm,"describe",a)},expression:"applyForm.describe"}})],1),e("el-form-item",{attrs:{label:"文件"}},[e("div",{staticClass:"fileWrap"},t._l(t.applyForm.fileList,(function(a,i){return e("div",{key:a.fileName,staticClass:"fileBox"},[e("span",{staticClass:"fileName"},[t._v(t._s(a.fileName))]),e("span",{staticClass:"fileSize"},[t._v(t._s(a.size))]),e("i",{staticClass:"el-icon-close",on:{click:function(a){return t.delFile(i)}}}),i+1!=t.applyForm.fileList.length?e("el-divider",{attrs:{direction:"vertical"}}):t._e()],1)})),0),e("div",{staticClass:"addFile",on:{click:function(a){return t.getFileList()}}},[e("i",{staticClass:"el-icon-plus"}),e("span",[t._v("添加文件")])])]),e("el-form-item",{attrs:{label:"审批人"}},[e("div",{staticClass:"member"},[e("div",{staticClass:"content"},t._l(t.applyForm.approvalUserList,(function(a){return e("div",{key:a},[e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(a)+" ")]),e("div",{staticClass:"contentBox"},[e("div",{staticClass:"memberBox"},[e("div",{staticClass:"iconBox"},[e("i",{staticClass:"iconfont icon-yonghutianchong"})]),e("span",{staticClass:"userBox"},[t._v(t._s(a))])]),e("div",{staticClass:"interval"})])])],1)})),0)])])],1)],1),e("div",{staticClass:"seniorWrap"},[e("div",{staticClass:"senior"},[e("div",{staticClass:"seniorTitle"},[t._v("高级选项")]),e("div",{staticClass:"seniorItem"},[e("el-checkbox",{model:{value:t.isPeriodValidity,callback:function(a){t.isPeriodValidity=a},expression:"isPeriodValidity"}},[t._v(" 文件下载有效期 ")]),e("div",{staticClass:"seniorContent"},[t._v(" 审批通过后 "),e("el-input-number",{staticStyle:{width:"100px","margin-left":"25px","margin-right":"10px"},attrs:{"controls-position":"right",min:0,size:"mini"},model:{value:t.applyForm.downloadDay,callback:function(a){t.$set(t.applyForm,"downloadDay",a)},expression:"applyForm.downloadDay"}}),t._v(" 天内有效 ")],1)],1),e("div",{staticClass:"seniorItem"},[e("el-checkbox",{model:{value:t.isDownloads,callback:function(a){t.isDownloads=a},expression:"isDownloads"}},[t._v("总下载次数")]),e("div",{staticClass:"seniorContent"},[t._v(" 文件下载次数 "),e("el-input-number",{staticStyle:{width:"100px",margin:"0px 10px"},attrs:{"controls-position":"right",min:0,size:"mini"},model:{value:t.applyForm.downloadCount,callback:function(a){t.$set(t.applyForm,"downloadCount",a)},expression:"applyForm.downloadCount"}}),t._v(" 单位：次 ")],1)],1)]),e("div",{staticClass:"btnWrap"},[e("el-button",{attrs:{type:"primary",size:"small",loading:t.loading},on:{click:function(a){return t.addDownloadApply(t.applyForm)}}},[t._v(" 确定 ")]),e("el-button",{attrs:{type:"info",size:"small"},on:{click:t.goBack}},[t._v("取消")])],1)])])]),e("el-dialog",{attrs:{visible:t.showFileDialog,width:"60%"},on:{"update:visible":function(a){t.showFileDialog=a}}},[e("template",{slot:"title"},[e("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[t._v(" 添加文件 ")])]),e("div",{staticClass:"breadCrumbBox"},[e("bread-crumb",{on:{startGetData:t.startGetData},model:{value:t.nowPath,callback:function(a){t.nowPath=a},expression:"nowPath"}})],1),e("div",{staticClass:"tableWrap"},[e("table-temp",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{config:t.tableConfig},on:{"selection-change":t.handleSelectionChange},scopedSlots:t._u([{key:"file",fn:function(a){return[e("span",{class:{clickable:a.row.dir},on:{click:function(e){a.row.dir&&t.getData(a.row.path)}}},[t._v(" "+t._s(a.row.name)+" ")])]}}])})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(a){t.showFileDialog=!1}}},[t._v(" 取 消 ")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addFile}},[t._v(" 确 定 ")])],1)],2),e("el-dialog",{attrs:{visible:t.tipsDialog,width:"450px"},on:{"update:visible":function(a){t.tipsDialog=a}}},[e("div",{staticClass:"tipsWrap"},[e("i",{staticClass:"el-icon-success"}),e("div",{staticClass:"label"},[t._v("文件下载申请成功")]),e("div",[t._v(" 点击审批单号 "),e("span",{staticClass:"applyId",on:{click:function(a){return t.jumpDetail(t.tipInfo)}}},[t._v(" "+t._s(t.tipInfo)+" ")]),t._v(" 查看审批详情 ")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:t.goBack}},[t._v("关 闭")])],1)])],1)},l=[],s=(e("a434"),e("d3b7"),e("d81d"),e("b0c0"),e("4de4"),e("75ba")),o=e("8efb"),n=e("2c4e"),r=e("b8f0"),p={name:"newOrEditApply",components:{pageFrame:s["a"],tableTemp:o["a"],breadCrumb:n["a"]},data:function(){return{loading:!1,tipInfo:"",tipsDialog:!1,nowPath:"/",isDownloads:!1,isPeriodValidity:!1,showFileDialog:!1,tableLoading:!1,type:0,applyForm:{applyUser:"",applyEmail:"",applyTheme:"",describe:"",applyType:1,downloadDay:1,downloadCount:1,fileList:[],approvalUserList:[]},formRule:{applyEmail:[{required:!0,message:"请输入邮箱",trigger:"blur"}],applyTheme:[{required:!0,message:"请输入主题",trigger:"blur"}],describe:[{required:!0,message:"请输入描述",trigger:"blur"}]},tableConfig:{tableData:[],maxHeight:"550px",selection:!0,border:!1,tableSetting:[{prop:"name",label:"文件名",slot:"file"},{prop:"size",label:"大小",formatter:function(t){return t.dir?"-":Object(r["d"])(t.size)}},{prop:"lastModified",label:"修改日期"}],condition:{path:""},fetchUrl:"getFileList"},approvalMode:{1:"会签",2:"或签",3:"依次审批"},levelObj:{1:"直接上级",2:"第二级上级",3:"第三级上级",4:"第四级上级",5:"第五级上级",6:"第六级上级"},selectFiles:[],rootPath:""}},created:function(){},mounted:function(){var t=this,a=this.$route.params;this.applyTitle=0==a.type?"新建下载申请":"编辑下载申请",this.$nextTick((function(){t.applyForm=a.data,t.type=a.type})),this.getCurrentApprovalUser()},methods:{jumpDetail:function(t){this.$router.push({name:"approval",params:{accountType:"2",approvalState:2,applyId:t}})},startGetData:function(t){t&&this.getData(this.nowPath)},goBack:function(){this.$router.go(-1)},delFile:function(t){this.applyForm.fileList.splice(t,1)},getData:function(t){var a,e=this;this.tableLoading=!0,a=t?"/"==t[t.length-1]?t:t+"/":"/",this.$http("getFileList",{path:a}).then((function(t){e.tableConfig.tableData=t.data,e.nowPath=a})).finally((function(){e.tableLoading=!1}))},addFile:function(){var t=this.selectFiles.map((function(t){return{fileSize:t.size,size:Object(r["d"])(t.size),filePath:t.path,fileName:t.name}}));this.$set(this.applyForm,"fileList",t),this.showFileDialog=!1},getFileList:function(){this.showFileDialog=!0,this.getData("/")},addDownloadApply:function(t){var a=this;this.$refs["applyForm"].validate((function(e){e&&(a.applyForm.fileList.length>0?(a.loading=!0,a.isDownloads||(a.applyForm.downloadCount=0),a.isPeriodValidity||(a.applyForm.downloadDay=0),0==a.type?a.$http("createApply",t).then((function(t){a.tipsDialog=!0,a.tipInfo=t.data})).finally((function(){a.loading=!1,a.showNewApply=!1})):a.$http("updateApply",t).then((function(t){a.$message.success(t.errMsg),a.goBack()})).finally((function(){a.loading=!1,a.showNewApply=!1}))):a.$message.warning("请选择至少一个文件"))}))},handleSelectionChange:function(t){this.selectFiles=t.filter((function(t){if(!t.dir)return t}))},getCurrentApprovalUser:function(){var t=this;this.$http("getCurrentApprovalUser").then((function(a){t.applyForm.approvalUserList=a.data}))}}},c=p,d=(e("1fd7"),e("2877")),u=Object(d["a"])(c,i,l,!1,null,"3b6f83b4",null);a["default"]=u.exports},f2d1:function(t,a,e){}}]);