(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63bcf36d"],{"0e09":function(e,t,i){},1276:function(e,t,i){"use strict";var n=i("2ba4"),a=i("c65b"),o=i("e330"),l=i("d784"),s=i("44e7"),r=i("825a"),c=i("1d80"),f=i("4840"),p=i("8aa5"),d=i("50c4"),g=i("577e"),h=i("dc4a"),u=i("4dae"),m=i("14c3"),C=i("9263"),b=i("9f7f"),x=i("d039"),v=b.UNSUPPORTED_Y,y=4294967295,w=Math.min,S=[].push,D=o(/./.exec),_=o(S),k=o("".slice),I=!x((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]}));l("split",(function(e,t,i){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var o=g(c(this)),l=void 0===i?y:i>>>0;if(0===l)return[];if(void 0===e)return[o];if(!s(e))return a(t,o,e,l);var r,f,p,d=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,b=new RegExp(e.source,h+"g");while(r=a(C,b,o)){if(f=b.lastIndex,f>m&&(_(d,k(o,m,r.index)),r.length>1&&r.index<o.length&&n(S,d,u(r,1)),p=r[0].length,m=f,d.length>=l))break;b.lastIndex===r.index&&b.lastIndex++}return m===o.length?!p&&D(b,"")||_(d,""):_(d,k(o,m)),d.length>l?u(d,0,l):d}:"0".split(void 0,0).length?function(e,i){return void 0===e&&0===i?[]:a(t,this,e,i)}:t,[function(t,i){var n=c(this),l=void 0==t?void 0:h(t,e);return l?a(l,t,n,i):a(o,g(n),t,i)},function(e,n){var a=r(this),l=g(e),s=i(o,a,l,n,o!==t);if(s.done)return s.value;var c=f(a,RegExp),h=a.unicode,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(v?"g":"y"),C=new c(v?"^(?:"+a.source+")":a,u),b=void 0===n?y:n>>>0;if(0===b)return[];if(0===l.length)return null===m(C,l)?[l]:[];var x=0,S=0,D=[];while(S<l.length){C.lastIndex=v?0:S;var I,L=m(C,v?k(l,S):l);if(null===L||(I=w(d(C.lastIndex+(v?S:0)),l.length))===x)S=p(l,S,h);else{if(_(D,k(l,x,S)),D.length===b)return D;for(var z=1;z<=L.length-1;z++)if(_(D,L[z]),D.length===b)return D;S=x=I}}return _(D,k(l,x)),D}]}),!I,v)},1293:function(e,t,i){"use strict";i("f2d1")},"190f":function(e,t,i){"use strict";i("0e09")},"1fa3":function(e,t,i){"use strict";i("431e")},"431e":function(e,t,i){},7044:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"box"},[i("page-frame",{attrs:{title:"用户管理",icon:"userManage",aside:!0,asideWidth:"210px"},scopedSlots:e._u([{key:"aside",fn:function(){return[i("el-input",{staticStyle:{margin:"10px 10px 10px 0px",width:"190px"},attrs:{size:"mini",placeholder:"请输入部门名称"},model:{value:e.filterDep,callback:function(t){e.filterDep=t},expression:"filterDep"}}),i("el-tree",{ref:"tree",staticStyle:{width:"300px"},attrs:{props:e.props,load:e.loadNode,"filter-node-method":e.filterNode,"node-key":"name","highlight-current":"",lazy:"","empty-text":"暂无数据"},on:{"node-click":e.nodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,a=t.data;return i("span",{staticClass:"nodeItem"},[i("el-popover",{attrs:{placement:"right",trigger:"hover","open-delay":300}},[i("div",[i("div",{staticClass:"operation"},[i("div",{staticClass:"opItem",on:{click:function(t){return e.changeName(a)}}},[e._v("修改名称")]),i("div",{staticClass:"opItem",on:{click:function(t){return e.setSuperior(a.dn)}}},[e._v(" 设置上级 ")])])]),i("span",{staticStyle:{"font-size":"13px"},attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(n.label)+" ")])])],1)}}])})]},proxy:!0}])},[i("div",{staticClass:"header"},[i("el-input",{staticStyle:{width:"250px","margin-right":"10px"},attrs:{size:"small",placeholder:"请输入用户名或真实姓名查询",clearable:""},model:{value:e.filterUser,callback:function(t){e.filterUser=t},expression:"filterUser"}}),i("div",{staticClass:"rightWrap"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.setSuperior(e.tempDn)}}},[e._v(" 设置上级 ")]),i("el-button",{attrs:{type:"warning",size:"small",loading:e.exportLoading},on:{click:e.exported}},[e._v(" 导出Excel ")])],1)],1),i("table-temp",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{config:e.tableConfig},scopedSlots:e._u([{key:"userId",fn:function(t){return[i("div",{staticClass:"userBox"},[i("span",[e._v(e._s(t.row.userId))]),t.row.isTop?i("el-tag",{staticStyle:{float:"right"},attrs:{size:"mini"}},[e._v(" 上级 ")]):e._e()],1)]}}])})],1),i("el-dialog",{attrs:{visible:e.setSuperiorDialog,width:"650px"},on:{"update:visible":function(t){e.setSuperiorDialog=t}}},[i("template",{slot:"title"},[i("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" 设置部门上级 ")])]),i("div",{staticClass:"contentBox"},[i("div",{staticClass:"leftBox"},[i("el-input",{staticStyle:{width:"90%","margin-bottom":"10px"},attrs:{"suffix-icon":"el-icon-search",size:"small",placeholder:"输入用户名进行筛选"},model:{value:e.filterUser1,callback:function(t){e.filterUser1=t},expression:"filterUser1"}}),i("div",{staticClass:"leftContent"},[i("el-checkbox-group",{model:{value:e.tempSuperior,callback:function(t){e.tempSuperior=t},expression:"tempSuperior"}},e._l(e.depUserList,(function(t){return i("el-checkbox",{key:t.userId,attrs:{label:t.userId}},[i("div",{staticClass:"checkItem"},[e._v(" "+e._s(t.userId)+" ")])])})),1)],1)],1),i("div",{staticClass:"rightBox"},[i("div",{staticClass:"title"},[e._v("已选择的成员")]),i("div",{staticClass:"rightContent"},e._l(e.tempSuperior,(function(t){return i("el-tag",{key:t,staticStyle:{margin:"5px"},attrs:{closable:""},on:{close:function(i){return e.delSuperior(t)}}},[e._v(" "+e._s(t)+" ")])})),1)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.setSuperiorDialog=!1}}},[e._v(" 取 消 ")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmSuperior}},[e._v(" 确 定 ")])],1)],2),i("el-dialog",{attrs:{visible:e.editNameDialog,width:"450px"},on:{"update:visible":function(t){e.editNameDialog=t}}},[i("template",{slot:"title"},[i("div",{staticStyle:{height:"20px","line-height":"20px","border-left":"4px solid #1890ff","padding-left":"10px"}},[e._v(" 编辑部门名称 ")])]),i("div",[e._v("新部门名称")]),i("el-input",{attrs:{size:"small",placeholder:"请输入名称"},model:{value:e.editInfo.name,callback:function(t){e.$set(e.editInfo,"name",t)},expression:"editInfo.name"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.cancelEdit}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.alterName}},[e._v(" 确 定 ")])],1)],2)],1)},a=[],o=(i("4de4"),i("d3b7"),i("b0c0"),i("d81d"),i("75ba")),l=i("8efb"),s={name:"userManage",components:{pageFrame:o["a"],TableTemp:l["a"]},data:function(){return{oldName:"",editNameDialog:!1,setSuperiorDialog:!1,filterUser1:"",filterUser:"",filterDep:"",tempDn:"",editInfo:{},props:{label:"name",isLeaf:"leaf"},fullData1:[],fullData:[],tempSuperior:[],depUserList:[],tableLoading:!1,tableConfig:{tableData:[],border:!0,maxHeight:"10000px",tableSetting:[{prop:"userId",label:"用户名",align:"left",slot:"userId"},{prop:"realName",label:"真实姓名"},{prop:"department",label:"部门"},{prop:"tel",label:"手机号"},{prop:"email",label:"邮箱"}]},exportLoading:!1}},created:function(){},mounted:function(){this.tableConfig.maxHeight=document.body.clientHeight-225+"px"},watch:{filterDep:function(e){this.$refs.tree.filter(e)},filterUser:function(e){this.$set(this.tableConfig,"tableData",this.fullData.filter((function(t){if(t.userId&&-1!=t.userId.toLowerCase().indexOf(e.toLowerCase())||t.realName&&-1!=t.realName.toLowerCase().indexOf(e.toLowerCase()))return t})))},filterUser1:function(e){this.depUserList=this.fullData1.filter((function(t){if(-1!=t.userId.indexOf(e))return t}))}},methods:{cancelEdit:function(){this.editNameDialog=!1,this.editInfo.name=this.oldName},alterName:function(){var e=this;this.editInfo.name?this.$http("updateDepartmentName",{dn:this.editInfo.dn,name:this.editInfo.name}).then((function(t){e.$message.success(t.errMsg),e.editNameDialog=!1})):this.$message.warning("名称不能为空")},exported:function(){var e=this;this.exportLoading=!0,this.$http("exportDepartmentUserList",{dn:this.tempDn}).then((function(t){e.$message.success(t.errMsg),window.open(window.urlHead+t.data)})).finally((function(){e.exportLoading=!1}))},confirmSuperior:function(){var e=this;this.$http("setDepartmentSuperior",{dn:this.tempDn,userList:this.tempSuperior}).then((function(t){e.$message.success(t.errMsg)})).finally((function(){e.setSuperiorDialog=!1,e.getData(e.tempDn)}))},delSuperior:function(e){this.tempSuperior=this.tempSuperior.filter((function(t){return t!=e}))},changeName:function(e){this.editNameDialog=!0,this.editInfo=e,this.oldName=e.name},setSuperior:function(e){var t=this;this.filterUser1="",e?(this.tempDn=e,this.tempSuperior=[],this.$http("getDepartmentUserList",{dn:e}).then((function(e){t.depUserList=e.data,t.fullData1=e.data,e.data.map((function(e){e.isTop&&t.tempSuperior.push(e.userId)}))})).finally((function(){t.setSuperiorDialog=!0}))):this.$message.warning("请选择设置上级的部门")},loadNode:function(e,t){var i=this,n=0==e.level?"":e.data.dn;this.$http("getDepartmentList",{dn:n}).then((function(n){var a=[];n.data.map((function(e){a.push({name:e.name,dn:e.dn,leaf:!e.haveChildDepartment})})),t(a),0==e.level&&(i.tempDn=n.data[0].dn,i.getData(n.data[0].dn))}))},getData:function(e){var t=this;this.tableLoading=!0,this.$http("getDepartmentUserList",{dn:e}).then((function(e){t.fullData=e.data,t.tableConfig.tableData=e.data})).finally((function(){t.tableLoading=!1}))},nodeClick:function(e){this.tempDn=e.dn,this.tableLoading=!0,this.getData(e.dn)},filterNode:function(e,t){return!e||-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}}},r=s,c=(i("1fa3"),i("2877")),f=Object(c["a"])(r,n,a,!1,null,"76c4ec1c",null);t["default"]=f.exports},"75ba":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pageBox"},[i("el-header",{staticStyle:{height:"25px","line-height":"25px"}},[i("i",{class:"iconfont icon-"+e.icon}),i("span",{staticClass:"title"},[e._v(e._s(e.title))]),i("div",{staticClass:"headBtn"},[e._t("headBtn")],2)]),i("el-divider"),i("el-container",[e.aside?i("el-aside",{staticStyle:{"border-right":"0.5px solid #d9d9d9"},attrs:{width:e.asideWidth||"185px"}},[e._t("aside")],2):e._e(),i("el-main",[e._t("default")],2)],1)],1)},a=[],o={name:"pageFrame",props:["aside","title","icon","asideWidth"],data:function(){return{}},created:function(){},methods:{}},l=o,s=(i("1293"),i("2877")),r=Object(s["a"])(l,n,a,!1,null,"4bf95040",null);t["a"]=r.exports},"8efb":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"tableTempWrap",staticClass:"table-temp"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.innerLoading,expression:"innerLoading"}],ref:"elTable",staticClass:"farm-table-temp",attrs:{"max-height":e.cloneConfig.maxHeight,loadingText:"正在加载表格数据","empty-text":e.emptyText,data:e.cloneConfig.tableData,"header-cell-style":e.cloneConfig.headerCellStyle,border:e.cloneConfig.border,"row-key":e.cloneConfig.rowKey,lazy:"","default-sort":e.cloneConfig.defaultSort,load:e.cloneConfig.loadFn,stripe:"undefined"==typeof e.cloneConfig.stripe||e.cloneConfig.stripe,size:"small"},on:{"row-click":e.rowClick,"expand-change":e.expandChange,"selection-change":e.handleSelectionChange,"sort-change":e.handleSortChange,"cell-mouse-enter":e.cellMouseEnter,"cell-mouse-leave":e.cellMouseLeave,"cell-click":e.cellClick,toggleRowSelection:e.toggleRowSelection}},[e.cloneConfig.selection?i("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}):e._e(),e.cloneConfig.serialNumber?i("el-table-column",{attrs:{type:"index",align:"center",width:"55"}}):e._e(),e.cloneConfig.expand?i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("expand",null,{row:t.row,index:t.$index})]}}],null,!0)}):e._e(),e._l(e.cloneConfig.tableSetting,(function(t,n){return i("el-table-column",{key:n,staticClass:"column",attrs:{label:t.label,prop:t.prop,align:t.align||"center","min-width":t.minWidth||120,width:t.width,fixed:t.fixed,"show-overflow-tooltip":"",filters:t.filters,"filter-method":t.filterMethod,sortable:t.sortable||!1},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.slot,(function(){return[i("span",{directives:[{name:"show",rawName:"v-show",value:"function"===typeof t.show?t.show(a.row):!1!==t.show,expression:"\n              typeof item.show === 'function'\n                ? item.show(scope.row)\n                : item.show === false\n                ? false\n                : true\n            "}],style:t.style?"function"===typeof t.style?t.style(a.row):t.style:{},attrs:{title:t.title},on:{click:function(e){!t.click||("function"===typeof t.click?t.click(a.row):t.click)}}},[e._v(" "+e._s("function"===typeof t.formatter?t.formatter(a.row,a.column,a.row[t.prop],n):a.row[t.prop])+" ")])]}),{row:a.row})]}}],null,!0)})})),e.cloneConfig.operation?i("el-table-column",{attrs:{align:"center",fixed:e.cloneConfig.operation.fixed||"right",label:e.cloneConfig.operation.label||"操作","min-width":e.cloneConfig.operation.minWidth||150,width:e.cloneConfig.operation.width},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("btn",(function(){return e._l(e.cloneConfig.operation.btns,(function(n,a){return i("el-button",{directives:[{name:"show",rawName:"v-show",value:"function"===typeof n.show?n.show(t.row):!1!==n.show,expression:"\n              typeof item.show === 'function'\n                ? item.show(scope.row)\n                : item.show === false\n                ? false\n                : true\n            "}],key:a,attrs:{disabled:!!n.disabled&&("function"===typeof n.disabled?n.disabled(t.row):!1!==n.disabled),size:n.size||"mini",type:n.type||"text"},on:{click:function(e){return n.fn(t.row)}}},[n.href?i("a",{style:"function"===typeof n.style?n.style(t.row):n.style,attrs:{href:n.href}},[e._v(" "+e._s("function"===typeof n.label?n.label(t.row):n.label)+" ")]):i("span",{style:"function"===typeof n.style?n.style(t.row):n.style},[e._v(" "+e._s("function"===typeof n.label?n.label(t.row):n.label)+" ")])])}))}),{row:t.row})]}}],null,!0)}):e._e()],2),e.cloneConfig.page?i("div",{ref:"reportNav",staticClass:"report-nav"},[i("el-pagination",{attrs:{"current-page":e.cloneConfig.page.pageIndex,"page-size":e.cloneConfig.page.pageSize,"page-sizes":e.cloneConfig.page.pageSizes,layout:e.layout,total:e.cloneConfig.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.cloneConfig.page,"pageIndex",t)},"update:current-page":function(t){return e.$set(e.cloneConfig.page,"pageIndex",t)}}})],1):e._e()],1)},a=[],o=i("5530"),l=(i("d81d"),i("d3b7"),i("ac1f"),i("1276"),i("fb6a"),i("b8f0")),s=i("5c96"),r={name:"TableTemp",props:Object(o["a"])({config:{type:Object,require:!0},loading:{type:Boolean,default:!1}},s["Table"].props),watch:{"config.tableData":function(){this.init()}},data:function(){return{sortAble:!1,responseData:null,showSelectList:!1,cloneConfig:{map:{data:"data.items",total:"data.total"},resetIndex:!0},layout:"prev, pager, next, jumper",clientMaxHeight:200,isSizeOrIndexChange:!1,innerLoading:!1}},methods:{handleSortChange:function(e){this.sortAble=!0,this.$emit("sortChange",e)},cellMouseEnter:function(e){this.$emit("cellMouseEnter",e)},cellMouseLeave:function(e){this.$emit("cellMouseLeave",e)},toggleRowSelection:function(e){this.$emit("toggleRowSelection",e)},cellClick:function(e,t,i){this.$emit("cellClick",e,t,i)},getLayout:function(){this.cloneConfig.page&&this.cloneConfig.page.pageSizes&&(this.layout="sizes, "+this.layout),this.cloneConfig.page&&(0===this.cloneConfig.page.total||this.cloneConfig.page.total)&&(this.layout="total, "+this.layout)},handleSelectionChange:function(e){this.$emit("selection-change",e)},handleSizeChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageSize=e,this.cloneConfig.page.pageIndex=1,this.isSizeOrIndexChange=!0),"undefined"!==this.cloneConfig.fetchUrl?this.fetch():this.splitData()},handleCurrentChange:function(e){this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=e,this.isSizeOrIndexChange=!0),"undefined"!==this.cloneConfig.fetchUrl?this.fetch():this.splitData()},fetch:function(e){var t,i,n=this;if(this.cloneConfig.fetchUrl)try{!this.cloneConfig.resetIndex&&this.sortAble||this.resetIndex();var a=Object(o["a"])({},this.cloneConfig.condition);if(this.cloneConfig.page){var l="pageSize",s="pageIndex";this.cloneConfig.page.map&&(l=this.cloneConfig.page.map.size||"pageSize",s=this.cloneConfig.page.map.index||"pageIndex"),a[l]=this.cloneConfig.page.pageSize||15,a[s]=this.cloneConfig.page.pageIndex||1}this.innerLoading=!0,this.$emit("update:loading",!0),void 0!=e&&"get"==e&&(a.methodName=e),this.cloneConfig.map&&this.cloneConfig.map.ContentType?(t=this.cloneConfig.map.ContentType,i=this.$http(this.config.fetchUrl,a,{headers:{"Content-Type":t}})):i=this.$http(this.config.fetchUrl,a),i.then((function(e){n.responseData=e;var t=n.dataMap(e,n.cloneConfig.map.data)||[];if(n.cloneConfig.dataProcess&&(t=n.cloneConfig.dataProcess(t)),n.cloneConfig.tableData=t,n.config.tableData=t,n.config.page&&(0===n.config.page.total||n.config.page.total)){var i=n.dataMap(e,n.cloneConfig.map.total)||0;n.cloneConfig.page&&n.$set(n.cloneConfig.page,"total",i)}}),(function(){n.clearData()})).finally((function(){n.$emit("afterFetch",n.responseData),n.$emit("update:loading",!1),n.innerLoading=!1})),this.sortAble=!1}catch(r){this.innerLoading=!1,this.$emit("update:loading",!1),console.log("%c%s","color: red",r)}else console.log("%c没有fetchUrl，请检查","color: red")},clearData:function(){this.cloneConfig.tableData=[],this.cloneConfig.page&&(this.cloneConfig.page.pageIndex=1)&&(this.cloneConfig.page.total=0)},dataMap:function(e,t){try{var i=t.split("."),n=Object(l["a"])(e);while(i.length>0)n=n[i.shift()];return n}catch(a){console.log("数据映射出错%c%s","color: red",a)}},rowClick:function(e,t,i){this.$emit("row-click",e,t,i)},expandChange:function(e,t){this.$emit("expand-change",e,t)},resetIndex:function(){this.cloneConfig.page&&!this.isSizeOrIndexChange?(this.$set(this.cloneConfig.page,"pageIndex",1),this.isSizeOrIndexChange=!1):this.isSizeOrIndexChange=!1},getMaxHeight:function(){var e=this.$refs.tableTempWrap,t=this.$refs.reportNav;this.clientMaxHeight=e.clientHeight-(t?t.offsetHeight:0)},splitData:function(){var e=this.cloneConfig.page&&this.cloneConfig.page.pageIndex||1,t=this.cloneConfig.page&&this.cloneConfig.page.pageSize||15,i=this.config.tableData.length>t?t:this.config.tableData.length;this.cloneConfig.tableData=this.config.tableData.slice((e-1)*t,(e-1)*t+i),this.config.page&&(this.cloneConfig.page.total=this.config.tableData.length)},init:function(){"undefined"===typeof this.config.fetchUrl&&this.config.page?(this.cloneConfig=Object(l["a"])(this.config),this.splitData()):this.cloneConfig=Object(l["b"])(this.config,this.cloneConfig),this.loading&&(this.innerLoading=this.loading)}},created:function(){this.init(),this.getLayout()},mounted:function(){}},c=r,f=(i("190f"),i("2877")),p=Object(f["a"])(c,n,a,!1,null,"7fae086a",null);t["a"]=p.exports},f2d1:function(e,t,i){}}]);